<div id="catalogues-form" class="page-layout carded fullwidth" fusePerfectScrollbar>
    <!-- TOP BACKGROUND -->
    <div class="accent"></div>
    <!-- / TOP BACKGROUND -->

    <!-- CENTER -->
    <div class="center" fxLayout="column" fxLayoutAlign="space-between none" fxLayoutGap="25px">
        <!-- CONTENT HEADER -->
        <!-- <div class="header sinbad" fxLayout="row" fxLayoutAlign="space-between center"></div> -->
        <!-- / CONTENT HEADER -->

        <!-- CONTENT CARD (INFORMASI PRODUK) -->
        <div class="content-card mt-16">
            <div class="p-16">
                <div class="h1">Informasi Produk</div>
            </div>
        
            <div class="p-16 pt-0 line-height-1.75">
                <form class="w-100-p" [formGroup]="form" fxLayout="column" fxFlex novalidate>
                    <!-- PRODUCT ID -->
                    <div
                        class="custom-field"
                        fxLayout="row"
                        fxLayoutAlign="space-between stretch"
                        formGroupName="productInfo"
                    >
                        <label
                            fxFlexAlign="center"
                            fxFlex="12"
                            [class.mat-error]="
                                form.get('productInfo.externalId').errors &&
                                !form.get('productInfo.externalId').untouched &&
                                (form.get('productInfo.externalId').dirty || form.get('productInfo.externalId').touched)
                            "
                        >
                            *Produk ID
                        </label>
                
                        <mat-form-field appearance="outline" fxFlex="80">
                            <input
                                hidden
                                matInput
                                name="id"
                                formControlName="id"
                            />
                            <input
                                matInput
                                name="externalId"
                                formControlName="externalId"
                            />
                        </mat-form-field>
                    </div>
                    <!-- / PRODUCT ID -->
                    <!-- NAMA PRODUK -->
                    <div
                        class="custom-field"
                        fxLayout="row"
                        fxLayoutAlign="space-between stretch"
                        formGroupName="productInfo"
                    >
                        <label
                            fxFlexAlign="center"
                            fxFlex="12"
                            [class.mat-error]="
                                form.get('productInfo.name').errors &&
                                !form.get('productInfo.name').untouched &&
                                (form.get('productInfo.name').dirty || form.get('productInfo.name').touched)
                            "
                        >
                            *Nama Produk
                        </label>
                
                        <mat-form-field appearance="outline" fxFlex="80">
                            <input
                                matInput
                                name="name"
                                formControlName="name"
                            />
                        </mat-form-field>
                    </div>
                    <!-- / NAMA PRODUK -->
                    <!-- DESKRIPSI PRODUK -->
                    <div
                        class="custom-field"
                        fxLayout="row"
                        fxLayoutAlign="space-between strectch"
                        formGroupName="productInfo"
                        style="margin-bottom: 21.5px;"
                    >
                        <label
                            fxFlex="20"
                            style="padding-top: 1.5em;"
                            [class.mat-error]="
                                form.get('productInfo.description').errors &&
                                !form.get('productInfo.description').untouched &&
                                (form.get('productInfo.description').dirty || form.get('productInfo.description').touched)
                            "
                        >
                            Deskripsi Produk
                        </label>
                
                        <div fxFlex="80" fxLayout="column" fxLayoutAlign="start start" fxLayoutGap="20px">
                            <quill-editor format='html' formControlName="description"></quill-editor>
                            <!-- <code>
                                {{ form.get('productInfo.description').value }}
                            </code> -->
                        </div>
                        <!-- <mat-form-field appearance="outline" fxFlex="80">
                            <textarea
                                matInput
                                name="description"
                                formControlName="description"
                            ></textarea>
                        </mat-form-field> -->
                    </div>
                    <!-- / DESKRIPSI PRODUK -->
                    <!-- VARIAN PRODUK -->
                    <!-- <div
                        class="custom-field"
                        fxLayout="row"
                        fxLayoutAlign="space-between start"
                        formGroupName="productInfo"
                    >
                        <label
                            fxFlexAlign="center"
                            fxFlex="12"
                            [class.mat-error]="
                                form.get('productInfo.variant').errors &&
                                !form.get('productInfo.variant').untouched &&
                                (form.get('productInfo.variant').dirty || form.get('productInfo.variant').touched)
                            "
                        >
                            *Variant
                        </label>
                
                        <mat-form-field appearance="outline" fxFlex="80">
                            <input
                                matInput
                                name="variant"
                                formControlName="variant"
                            />
                        </mat-form-field>
                    </div> -->
                    <!-- / VARIAN PRODUK -->
                    <!-- BRAND PRODUK -->
                    <div
                        class="custom-field"
                        fxLayout="row"
                        fxLayoutAlign="space-between start"
                        formGroupName="productInfo"
                    >
                        <label
                            fxFlexAlign="center"
                            fxFlex="12"
                            [class.mat-error]="
                                form.get('productInfo.brandId').errors &&
                                !form.get('productInfo.brandId').untouched &&
                                (form.get('productInfo.brandId').dirty || form.get('productInfo.brandId').touched)
                            "
                        >
                            *Brand
                        </label>

                        <mat-form-field appearance="outline" fxFlex="80">
                            <mat-select
                                name="brandId"
                                formControlName="brandId"
                            >
                                <mat-option
                                    *ngFor="let brand of brands$ | async"
                                    [value]="brand.id"
                                >
                                    {{ brand.name }}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <!-- / BRAND PRODUK -->
                    <!-- KATEGORI PRODUK -->
                    <div
                        class="custom-field"
                        fxLayout="row"
                        fxLayoutAlign="start center"
                        formGroupName="productInfo"
                    >
                        <label
                            fxFlexAlign="center"
                            fxFlex="20"
                            [class.mat-error]="
                                form.get('productInfo.category').errors &&
                                !form.get('productInfo.category').untouched &&
                                (form.get('productInfo.category').dirty || form.get('productInfo.category').touched)
                            "
                        >
                            *Kategori
                        </label>
                
                        <label>
                            <strong fxFlexAlign="center" [innerHTML]="productCategory$"></strong>
                            <button
                                class="red-fg"
                                mat-icon-button
                                [disableRipple]="true"
                                style="margin-left: 10px;"
                                matTooltip="Change the category"
                                matTooltipPosition="right"
                                (click)="onEditCategory(form.get('productInfo.id').value)"
                            >
                                <mat-icon>edit</mat-icon>
                            </button>
                        </label>
                    </div>
                    <!-- / KATEGORI PRODUK -->
                    <!-- PRODUK STOK -->
                    <div
                        class="custom-field"
                        fxLayout="row"
                        fxLayoutAlign="space-between start"
                        formGroupName="productInfo"
                    >
                        <label
                            fxFlexAlign="center"
                            fxFlex="12"
                            [class.mat-error]="
                                form.get('productInfo.stock').errors &&
                                !form.get('productInfo.stock').untouched &&
                                (form.get('productInfo.stock').dirty || form.get('productInfo.stock').touched)
                            "
                        >
                            Product Stock
                        </label>
                
                        <mat-form-field appearance="outline" fxFlex="80">
                            <input
                                matInput
                                name="stock"
                                formControlName="stock"
                                mask="separator"
                                thousandSeparator="."
                            />
                        </mat-form-field>
                    </div>
                    <!-- / PRODUK STOK -->
                    <!-- UOM -->
                    <div
                        class="custom-field"
                        fxLayout="row"
                        fxLayoutAlign="space-between start"
                        formGroupName="productInfo"
                    >
                        <label
                            fxFlexAlign="center"
                            fxFlex="12"
                            [class.mat-error]="
                                form.get('productInfo.uom').errors &&
                                !form.get('productInfo.uom').untouched &&
                                (form.get('productInfo.uom').dirty || form.get('productInfo.uom').touched)
                            "
                        >
                            UOM 
                        </label>
                
                        <mat-form-field appearance="outline" fxFlex="80">
                            <mat-select
                                name="uom"
                                formControlName="uom"
                            >
                                <mat-option
                                    *ngFor="let unit of catalogueUnits$ | async"
                                    [value]="unit.id"
                                >
                                    {{ unit.unit }}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <!-- / UOM -->
                </form>
            </div>
        </div>
        <!-- / CONTENT CARD (INFORMASI PRODUK) -->

        <!-- CONTENT CARD (INFORMASI PENJUALAN) -->
        <div class="content-card">
            <div class="p-16">
                <div class="h1">Informasi Penjualan</div>
            </div>
        
            <div class="p-16 pt-0 line-height-1.75">
                <form class="w-100-p" [formGroup]="form" fxLayout="column" fxFlex novalidate>
                    <!-- HARGA PRODUK -->
                    <div
                        class="custom-field-right"
                        fxLayout="row"
                        fxLayoutAlign="space-between stretch"
                        formGroupName="productSale"
                    >
                        <label
                            fxFlexAlign="center"
                            fxFlex="18"
                            class="pr-0"
                            [class.mat-error]="
                                form.get('productSale.productPrice').errors &&
                                !form.get('productSale.productPrice').untouched &&
                                (form.get('productSale.productPrice').dirty || form.get('productSale.productPrice').touched)
                            "
                        >
                            *Sale Price
                        </label>
                
                        <mat-form-field appearance="outline" fxFlex="80">
                            <input
                                matInput
                                name="price"
                                formControlName="productPrice"
                                mask="separator.2"
                                thousandSeparator="."
                                prefix="Rp"
                            />
                        </mat-form-field>
                    </div>
                    <!-- / HARGA PRODUK -->
                    <!-- HARGA RETAIL -->
                    <div
                        class="custom-field-right"
                        fxLayout="row"
                        fxLayoutAlign="space-between stretch"
                        formGroupName="productSale"
                    >
                        <label
                            fxFlexAlign="center"
                            fxFlex="18"
                            class="pr-0"
                            [class.mat-error]="
                                form.get('productSale.retailPrice').errors &&
                                !form.get('productSale.retailPrice').untouched &&
                                (form.get('productSale.retailPrice').dirty || form.get('productSale.retailPrice').touched)
                            "
                        >
                            *Suggested <br/>Retail Price
                        </label>
                
                        <mat-form-field appearance="outline" fxFlex="80">
                            <input
                                matInput
                                name="price"
                                formControlName="retailPrice"
                                mask="separator.2"
                                thousandSeparator="."
                                prefix="Rp"
                            />
                        </mat-form-field>
                    </div>
                    <!-- / HARGA RETAIL -->
                    <!-- TAG PRODUK -->
                    <div
                        class="custom-field-right"
                        fxLayout="row"
                        fxLayoutAlign="space-between stretch"
                        formGroupName="productSale"
                    >
                        <label
                            fxFlexAlign="center"
                            fxFlex="18"
                            class="pr-0"
                            [class.mat-error]="
                                form.get('productSale.tags').errors &&
                                !form.get('productSale.tags').untouched &&
                                (form.get('productSale.tags').dirty || form.get('productSale.tags').touched)
                            "
                        >
                            *Product Tag
                        </label>
                
                        <mat-form-field appearance="outline" fxFlex="80">
                            <mat-chip-list #chipList aria-label="Tags">
                                <mat-chip *ngFor="let tag of (productTagsControls?.controls); index as $index;"
                                            selectable="true"
                                            removable="true"
                                            (removed)="onRemoveTag($index)">
                                    {{ tag.value }}
                                    <mat-icon matChipRemove>cancel</mat-icon>
                                </mat-chip>
                                <input
                                    [matChipInputFor]="chipList"
                                    [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                                    [matChipInputAddOnBlur]="true"
                                    (matChipInputTokenEnd)="onAddTag($event)"
                                    >
                            </mat-chip-list>
                        </mat-form-field>
                    </div>
                    <!-- / TAG PRODUK -->
                    <!-- VARIASI PRODUK (NO VARIANT) -->
                    <!-- <div
                        class="custom-field"
                        fxLayout="row"
                        fxLayoutAlign="space-between start"
                        formGroupName="productSale"
                        *ngIf="productVariantControls.length === 0; else hasVariants;"
                    >
                        <label
                            fxFlexAlign="center"
                            fxFlex="12"
                            [class.mat-error]="
                                form.get('productSale.variants').errors &&
                                !form.get('productSale.variants').untouched &&
                                (form.get('productSale.variants').dirty || form.get('productSale.variants').touched)
                            "
                        >
                            <p>Variasi</p>
                        </label>
                
                        <div
                            appearance="outline"
                            fxLayout="column"
                            fxLayoutAlign="space-between stretch"
                            fxFlex="80"
                        >
                            <button
                                mat-stroked-button
                                style="border-style: dashed; width: 100%;"
                                class="green--fg"
                                (click)="onAddVariant()"
                            >
                                <mat-icon>add_circle</mat-icon>
                                Aktifkan Variasi
                            </button>
                        </div>
                    </div> -->
                    <!-- / VARIASI PRODUK (NO VARIANT) -->
                    <!-- VARIASI PRODUK (HAS VARIANTS) -->
                    <ng-template
                        #hasVariants
                    >
                        <div
                            class="custom-field"
                            fxLayout="column"
                            fxLayoutAlign="space-between stretch"
                            formGroupName="productSale"
                        >
                            <div
                                *ngFor="let variant of productVariantControls; index as $index;"
                                fxLayout="row"
                                fxLayoutAlign="space-between start"
                            >
                                <!-- VARIATION LABEL -->
                                <label
                                    fxFlex="20"
                                    style="margin-top: 45px;"
                                >
                                    Variasi {{ $index + 1 }}
                                </label>
                                <!-- / VARIATION LABEL -->
                                <!-- PRODUCT VARIATION -->
                                <div
                                    fxFlex="80"
                                    fxLayout="row"
                                    fxLayoutAlign="space-around start"
                                    class="grey-100-bg"
                                    style="border-radius: 10px; padding: 20px 10px;"
                                    [style.margin-top]="$index > 0 ? '20px' : '0px'"
                                    [style.margin-bottom]="$index === productVariantControls.length - 1 ? '20px' : '0px'"
                                >
                                    <!-- LABEL FOR VARIANT SELECTIONS -->
                                    <label
                                        fxFlex="15"
                                        style="margin-top: 25px;"
                                    >
                                        Nama Pilihan
                                    </label>
                                    <!-- / LABEL FOR VARIANT SELECTIONS -->
                                    <!-- INPUT FOR VARIANT SELECTION -->
                                    <div
                                        fxFlex="70"
                                        fxLayout="column"
                                        fxLayoutAlign="space-between stretch"
                                    >
                                        <ng-container
                                            *ngFor="let variantSelection of productVariantControls[$index].controls; index as $indexSelection; last as $lastSelection;"
                                        >
                                            <div
                                                fxLayout="row"
                                                fxLayoutAlign="space-between stretch"
                                            >
                                                <mat-form-field
                                                    fxFlex="90"
                                                    appearance="outline"
                                                >
                                                    <input
                                                        matInput
                                                        placeholder="Masukkan Nama Variasi, contoh: warna, dll."
                                                        [formControl]="variantSelection"
                                                    />
                                                </mat-form-field>
                                                <!-- DELETE FOR VARIANT SELECTION -->
                                                <button
                                                    mat-button
                                                    fxFlex
                                                    style="margin-bottom: 20px;"
                                                    (click)="onRemoveVariantSelection($event, $index, $indexSelection)"
                                                >
                                                    <mat-icon>delete</mat-icon>
                                                </button>
                                                <!-- / DELETE FOR VARIANT SELECTION -->
                                            </div>
                                            <button
                                                mat-stroked-button
                                                style="border-style: dashed; width: 100%;"
                                                (click)="onAddVariantSelection($event, $index)"
                                                *ngIf="$lastSelection"
                                            >
                                                <mat-icon>add_circle</mat-icon>
                                                Tambah Pilihan ({{ productVariantControls[$index].controls.length }} / 20)
                                            </button>
                                        </ng-container>
                                    </div>
                                    <!-- / INPUT FOR VARIANT SELECTION -->
                                </div>
                                <!-- / PRODUCT VARIATION -->
                            </div>
                            <!-- BUTTON ADD VARIATION -->
                            <div
                                fxFlex
                                fxLayout="row"
                                fxLayoutAlign="space-between start"
                                style="margin-bottom: 15px;">
                                <button
                                    fxFlex="80"
                                    fxFlexOffset="20"
                                    mat-stroked-button
                                    style="border-style: dashed; width: 100%;"
                                    class="green--fg"
                                    (click)="onAddVariant()"
                                >
                                    <mat-icon>add_circle</mat-icon>
                                    Tambah Variasi
                                </button>
                            </div>
                        </div>
                    </ng-template>
                    <!-- / VARIASI PRODUK (HAs VARIANTS) -->
                    <!-- INFORMASI VARIASI PRODUK -->
                    <div
                        class="custom-field"
                        fxLayout="column"
                        fxLayoutGap="10px"
                        fxLayoutAlign="space-between stretch"
                        *ngIf="productVariantControls?.length > 0"
                    >
                        <ng-container
                            *ngFor="let variant of productVariantFormControls; index as $index; first as $first;"
                        >
                            <form
                                [formGroup]="variantForm"
                                fxLayout="row"
                                fxFlex novalidate
                                style="margin-top: 20px;"
                            >
                                <!-- LABEL -->
                                <label
                                    fxFlexAlign="center"
                                    fxFlex="20"
                                >
                                    <p>Daftar Variasi {{ $index + 1 }}</p>
                                </label>
                                <!-- / LABEL -->
                                <div fxFlex="80"
                                    fxLayout="row"
                                    fxLayoutGap="5px"
                                    fxLayoutAlign="space-between start"
                                >
                                    <!-- PRICE -->
                                    <mat-form-field
                                        fxFlex="20"
                                        appearance="outline"
                                    >
                                        <input
                                            matInput
                                            placeholder="Harga"
                                            [formControl]="variant.get('price')"
                                        />
                                    </mat-form-field>
                                    <!-- / PRICE -->
                                    <!-- STOCK -->
                                    <mat-form-field
                                        fxFlex="20"
                                        appearance="outline"
                                    >
                                        <label
                                            
                                        >
                                        </label>
                                        <input
                                            matInput
                                            placeholder="Stock"
                                            [formControl]="variant.get('stock')"
                                        />
                                    </mat-form-field>
                                    <!-- / STOCK -->
                                    <!-- SKU -->
                                    <mat-form-field
                                        fxFlex="20"
                                        appearance="outline"
                                    >
                                        <input
                                            matInput
                                            placeholder="SKU"
                                            [formControl]="variant.get('sku')"
                                        />
                                    </mat-form-field>
                                    <!-- / SKU -->
                                    <!-- APPLY BUTTON -->
                                    <button
                                        fxFlex
                                        mat-raised-button
                                        style="margin-top: 5px; width: 100%; height: 60%;"
                                        color="accent"
                                    >
                                        Terapkan ke Semua
                                    </button>
                                    <!-- / APPLY BUTTON -->
                                </div>
                            </form>
                            <div
                                fxLayout="row"
                                fxLayoutAlign="space-between stretch"
                            >
                                <label
                                    fxFlex="20"
                                    style="margin-top: 30px;"
                                >
                                    Informasi Variasi {{ $index + 1 }}
                                    <!-- {{ printLog(productVariantControls[$index]) }}
                                    {{ printLog(productVariantControls[$index]) }} -->
                                </label>
                                <table mat-table fxFlex="80" [dataSource]="productVariantSelectionData[$index]" class="mat-elevation-z8">
                                    <ng-container matColumnDef="name">
                                        <th mat-header-cell *matHeaderCellDef> Nama </th>
                                        <td mat-cell *matCellDef="let element; let $i = index;"
                                        >
                                            <ng-container
                                                *ngIf="productVariantControls[$index].controls[$i].value.length === 0; else hasVariantInput;"
                                            >
                                                Pilihan {{ $i + 1 }}
                                            </ng-container>
                                            <ng-template
                                                #hasVariantInput
                                            >
                                                {{ productVariantControls[$index].controls[$i].value }}
                                            </ng-template>
                                        </td>
                                    </ng-container>
                                    
                                    <ng-container matColumnDef="price">
                                        <th mat-header-cell *matHeaderCellDef> Harga </th>
                                        <td mat-cell *matCellDef="let element"> {{ variant.get('price').value }} </td>
                                    </ng-container>
                                    
                                    <ng-container matColumnDef="stock">
                                        <th mat-header-cell *matHeaderCellDef> Stock </th>
                                        <td mat-cell *matCellDef="let element"> {{ variant.get('stock').value }} </td>
                                    </ng-container>
                                    
                                    <ng-container matColumnDef="sku">
                                        <th mat-header-cell *matHeaderCellDef> SKU </th>
                                        <td mat-cell *matCellDef="let element"> {{ variant.get('sku').value }} </td>
                                    </ng-container>
                                    
                                    <tr mat-header-row *matHeaderRowDef="variantListColumns"></tr>
                                    <tr mat-row *matRowDef="let row; columns: variantListColumns;"></tr>
                                </table>
                            </div>
                        </ng-container>
                    </div>
                    <!-- / INFORMASI VARIASI PRODUK -->
                    <!-- DAFTAR VARIASI PRODUK -->
                    <div
                        class="custom-field"
                        fxLayout="column"
                        fxLayoutGap="10px"
                        fxLayoutAlign="space-between stretch"
                        *ngIf="productVariantControls?.length > 0"
                    >
                        <!-- <ng-container
                            *ngFor="let variant of productVariantFormControls; index as $index;"
                        >
                            
                        </ng-container> -->
                    </div>
                    <!-- / DAFTAR VARIASI PRODUK -->
                </form>
            </div>
        </div>
        <!-- / CONTENT CARD (INFORMASI PENJUALAN) -->

        <!-- CONTENT CARD (MEDIA PRODUK) -->
        <div class="content-card">
            <div class="p-16">
                <div class="h1">Pengaturan Media</div>
            </div>
        
            <div class="p-16 pt-0 line-height-1.75">
                <form class="w-100-p" [formGroup]="form" fxLayout="column" fxFlex novalidate>
                    <!-- HARGA PRODUK -->
                    <div
                        class="custom-field"
                        fxLayout="row"
                        fxLayoutGap="10px"
                        fxLayoutAlign="space-between stretch"
                        formGroupName="productMedia"
                    >
                        <label
                            fxFlexAlign="center"
                            fxFlex="20"
                            [class.mat-error]="
                                form.get('productMedia.photos').errors &&
                                !form.get('productMedia.photos').untouched &&
                                (form.get('productMedia.photos').dirty || form.get('productMedia.photos').touched)
                            "
                        >
                            Foto Produk
                        </label>
                                        
                        <div appearance="outline"
                            fxFlex="80"
                            fxLayout="row"
                            fxLayoutAlign="space-between start"
                            *ngFor="let photo of productPhotos.controls; let i = index;"
                        >
                            <div
                                fxFill
                                fxLayout="column"
                                fxLayoutAlign="space-between center"
                            >
                                <input
                                    hidden
                                    #photos
                                    type="file"
                                    (change)="onFileBrowse($event, i)"
                                />
                                <button
                                    *ngIf="!photo.value; else hasPhoto;"
                                    (click)="photos.click()"
                                    mat-stroked-button
                                    style="border-style: dashed; width: 100%; min-height: 130px;"
                                    class="red-fg red-border"
                                >
                                    <mat-icon>add_circle</mat-icon>
                                </button>
                                <ng-template #hasPhoto>
                                    <div
                                        fxLayout="row"
                                        fxLayoutAlign="space-between start"
                                    >
                                        <img [src]="photo.value"/>
                                        <button
                                            class="red-fg"
                                            mat-icon-button
                                            style="bottom: 20px; right: 22px;"
                                            (click)="onAbortUploadPhoto(photos, i)"
                                        >
                                            <mat-icon>remove_circle</mat-icon>
                                        </button>
                                    </div>
                                </ng-template>
                                <div *ngIf="i === 0; else optionalPhoto" fxLayout="column" fxLayoutAlign="space-between center">
                                    <p style="margin-bottom: 0px;">*Foto Utama</p>
                                    <button
                                        class="red-fg"
                                        matTooltip="Reset to original image"
                                        mat-icon-button
                                        (click)="onResetImage(i)"
                                        *ngIf="productOldPhotos?.controls[i]?.get('value')?.value
                                                && (productPhotos?.controls[i]?.value !== productOldPhotos?.controls[i]?.get('value')?.value); else noUndo;"
                                    >
                                        <mat-icon>undo</mat-icon>
                                    </button>
                                    <ng-template #noUndo>
                                        <button
                                            disabled
                                            mat-icon-button
                                        >
                                            <mat-icon></mat-icon>
                                        </button>
                                    </ng-template>
                                </div>
                                <ng-template #optionalPhoto>
                                    <div>
                                        <p style="margin-bottom: 0px;">Foto {{ i }}</p>
                                        <button
                                            class="red-fg"
                                            matTooltip="Reset to original image"
                                            mat-icon-button
                                            (click)="onResetImage(i)"
                                            *ngIf="productOldPhotos?.controls[i]?.get('value')?.value
                                                    && (productPhotos?.controls[i]?.value !== productOldPhotos?.controls[i]?.get('value')?.value); else noUndo;"
                                        >
                                            <mat-icon>undo</mat-icon>
                                        </button>
                                        <ng-template #noUndo>
                                            <button
                                                disabled
                                                mat-icon-button
                                            >
                                                <mat-icon></mat-icon>
                                            </button>
                                        </ng-template>
                                    </div>
                                </ng-template>
                            </div>
                        </div>
                    </div>
                    <!-- / HARGA PRODUK -->
                </form>
            </div>
        </div>
        <!-- / CONTENT CARD (MEDIA PRODUK) -->

        <!-- CONTENT CARD (PENGIRIMAN PRODUK) -->
        <div class="content-card">
            <div class="p-16">
                <div class="h1">Pengiriman</div>
            </div>
        
            <div class="p-16 pt-0 line-height-1.75">
                <form class="w-100-p" [formGroup]="form" fxLayout="column" fxFlex novalidate>
                    <!-- BERAT PER PCS PRODUK -->
                    <div
                        class="custom-field-right"
                        fxLayout="row"
                        fxLayoutAlign="space-between stretch"
                        formGroupName="productShipment"
                    >
                        <label
                            class="pr-0"
                            fxFlexAlign="center"
                            fxFlex="18"
                            [class.mat-error]="
                                form.get('productShipment.catalogueWeight').errors &&
                                !form.get('productShipment.catalogueWeight').untouched &&
                                (form.get('productShipment.catalogueWeight').dirty || form.get('productShipment.catalogueWeight').touched)
                            "
                        >
                            Berat per Pcs
                        </label>
                
                        <mat-form-field appearance="outline" fxFlex="80">
                            <input
                                matInput
                                name="weight"
                                formControlName="catalogueWeight"
                                mask="separator"
                                thousandSeparator="."
                                placeholder="in gram(s)"
                            />
                        </mat-form-field>
                    </div>
                    <!-- / BERAT PER PCS PRODUK -->
                    <!-- BERAT PER MASTER BOX PRODUK -->
                    <div
                        class="custom-field-right"
                        fxLayout="row"
                        fxLayoutAlign="space-between stretch"
                        formGroupName="productShipment"
                    >
                        <label
                            class="pr-0"
                            fxFlexAlign="center"
                            fxFlex="18"
                            [class.mat-error]="
                                form.get('productShipment.packagedWeight').errors &&
                                !form.get('productShipment.packagedWeight').untouched &&
                                (form.get('productShipment.packagedWeight').dirty || form.get('productShipment.packagedWeight').touched)
                            "
                        >
                            Berat per <br/>Master Box
                        </label>
                
                        <mat-form-field appearance="outline" fxFlex="80">
                            <input
                                matInput
                                name="weight"
                                formControlName="packagedWeight"
                                mask="separator"
                                thousandSeparator="."
                                placeholder="in gram(s)"
                            />
                        </mat-form-field>
                    </div>
                    <!-- / BERAT PER MASTER BOX PRODUK -->
                    <!-- DIMENSI PER PCS PRODUK -->
                    <div
                        class="custom-field-right"
                        fxLayout="row"
                        fxLayoutAlign="space-between stretch"
                        formGroupName="productShipment"
                    >
                        <label
                            class="pr-0"
                            fxFlexAlign="center"
                            fxFlex="18"
                            [class.mat-error]="
                                form.get('productShipment.catalogueDimension').errors &&
                                form.get('productShipment.catalogueDimension').touched &&
                                (form.get('productShipment.catalogueDimension').dirty || form.get('productShipment.catalogueDimension').touched)
                            "
                        >
                            Dimensi per <br/>Pcs
                        </label>

                        <mat-form-field appearance="outline" fxFlex="80">
                            <input matInput
                                name="width"
                                formControlName="catalogueDimension"
                                mask="separator"
                                thousandSeparator="."
                            />
                            <!-- <p matSuffix>cm³</p> -->
                            <p matSuffix>cm<sup>3</sup></p>
                        </mat-form-field>
                    </div>
                    <!-- / DIMENSI PER PCS PRODUK -->
                    <!-- DIMENSI PER MASTER BOX PRODUK -->
                    <div
                        class="custom-field-right"
                        fxLayout="row"
                        fxLayoutAlign="space-between stretch"
                        formGroupName="productShipment"
                    >
                        <label
                            fxFlexAlign="center"
                            fxFlex="18"
                            class="pr-0"
                            [class.mat-error]="
                                form.get('productShipment.packagedDimension').errors &&
                                form.get('productShipment.packagedDimension').touched &&
                                (form.get('productShipment.packagedDimension').dirty || form.get('productShipment.packagedDimension').touched)
                            "
                        >
                            Dimensi per <br/>Master Box
                        </label>

                        <mat-form-field appearance="outline" fxFlex="80">
                            <input matInput
                                name="width"
                                formControlName="packagedDimension"
                                mask="separator"
                                thousandSeparator="."
                            />
                            <!-- <p matSuffix>cm³</p> -->
                            <p matSuffix>cm<sup>3</sup></p>
                        </mat-form-field>
                    </div>
                    <!-- / DIMENSI PER MASTER BOX PRODUK -->
                    <!-- VARIASI PRODUK -->
                    <!-- <div
                        class="custom-field"
                        fxLayout="row"
                        fxLayoutAlign="space-between start"
                        formGroupName="productShipment"
                    >
                        <label
                            fxFlexAlign="center"
                            fxFlex="12"
                            [class.mat-error]="
                                form.get('productShipment.isDangerous').errors &&
                                !form.get('productShipment.isDangerous').untouched &&
                                (form.get('productShipment.isDangerous').dirty || form.get('productShipment.isDangerous').touched)
                            "
                        >
                            Barang berbahaya
                        </label>

                        <mat-checkbox
                            name="isDangerous"
                            appearance="outline" fxFlex="80"
                            formControlName="isDangerous"
                        >Text</mat-checkbox>
                    </div> -->
                    <!-- / VARIASI PRODUK -->
                    <!-- SERVICE PENGIRIMAN -->
                    <!-- <div
                        class="custom-field"
                        fxLayout="row"
                        fxLayoutAlign="space-between start"
                        formGroupName="productShipment"
                    >
                        <label
                            fxFlexAlign="center"
                            fxFlex="12"
                            [class.mat-error]="
                                form.get('productShipment.couriers').errors &&
                                !form.get('productShipment.couriers').untouched &&
                                (form.get('productShipment.couriers').dirty || form.get('productShipment.couriers').touched)
                            "
                        >
                            Service Pengiriman
                        </label>

                        <div 
                            style="border: 1px solid dimgray;"
                            fxLayout="column"
                            fxLayoutAlign="none"
                            fxFlex="80"
                            formArrayName="couriers"
                            >
                                <div
                                    appearance="outline"
                                    fxLayout="row"
                                    fxLayoutGap="5px"
                                    fxLayoutAlign="space-between end"
                                    style="padding: 0 10px;"
                                    *ngFor="let courier of productCourierControls; index as idx;"
                                >
                                    <p>{{ courier?.value?.name }}</p>
                                    <mat-slide-toggle [formControl]="courier?.value?.disabled"></mat-slide-toggle>        
                                </div>
                        </div>
                    </div> -->
                    <!-- / SERVICE PENGIRIMAN -->
                </form>
            </div>
        </div>
        <!-- / CONTENT CARD (PENGIRIMAN PRODUK) -->
        <!-- CONTENT CARD (PENGATURAN JUMLAH PRODUK) -->
        <div class="content-card">
            <div class="p-16">
                <div class="h1">Pengaturan Jumlah</div>
            </div>
        
            <div class="p-16 pt-0 line-height-1.75">
                <form class="w-100-p" [formGroup]="form" fxLayout="column" fxFlex novalidate>
                    <!-- QUANTITY PER MASTER BOX -->
                    <div
                        class="custom-field-right"
                        fxLayout="row"
                        fxLayoutAlign="space-between center"
                        formGroupName="productCount"
                    >
                        <label
                            class="pr-0"
                            fxFlexAlign="center"
                            fxFlex="18"
                            fxLayout="column"
                            fxLayoutAlign="center end"
                            [class.mat-error]="
                                form.get('productCount.qtyPerMasterBox').errors &&
                                !form.get('productCount.qtyPerMasterBox').untouched &&
                                (form.get('productCount.qtyPerMasterBox').dirty || form.get('productCount.qtyPerMasterBox').touched)
                            "
                        >
                            Quantity <br/>per Master Box
                        </label>
                
                        <mat-form-field appearance="outline" fxFlex="80">
                            <input
                                matInput
                                name="qtyPerMasterBox"
                                formControlName="qtyPerMasterBox"
                                mask="separator"
                                thousandSeparator="."
                            />
                        </mat-form-field>
                    </div>
                    <!-- / QUANTITY PER MASTER BOX -->
                    <!-- MINIMUM OF QUANTITY -->
                    <div
                        class="custom-field-right"
                        fxLayout="row"
                        fxLayoutAlign="space-between stretch"
                        formGroupName="productCount"
                    >
                        <label
                            class="pr-0"
                            fxFlexAlign="start"
                            fxFlex="18"
                            fxLayout="column"
                            fxLayoutAlign="center end"
                            [class.mat-error]="
                                form.get('productCount.minQtyValue').errors &&
                                !form.get('productCount.minQtyValue').untouched &&
                                (form.get('productCount.minQtyValue').dirty || form.get('productCount.minQtyValue').touched)
                            "
                        >
                            Minimum Order <br/>Quantity
                        </label>

                        <div fxLayout="column" fxLayoutAlign="space-between stretch" fxLayoutGap="5px" fxFlex="80">
                            <!-- RADIO BUTTON SELECT TYPE -->
                            <mat-radio-group formControlName="minQtyOption">
                                <mat-radio-button class="pr-36" *ngFor="let choice of quantityChoices;" [value]="choice.id">{{ choice.label }}</mat-radio-button>
                            </mat-radio-group>
                            <!-- / RADIO BUTTON SELECT TYPE -->
                            <!-- INPUT TEXT BOX -->
                            <mat-form-field appearance="outline">
                                <input matInput
                                    name="minQtyValue"
                                    formControlName="minQtyValue"
                                    mask="separator"
                                    thousandSeparator="."
                                />
                            </mat-form-field>
                            <!-- / INPUT TEXT BOX -->
                        </div>
                    </div>
                    <!-- / MINIMUM OF QUANTITY -->
                    <!-- ADDITIONAL QUANTITY -->
                    <div
                        class="custom-field-right"
                        fxLayout="row"
                        fxLayoutAlign="space-between stretch"
                        formGroupName="productCount"
                    >
                        <label
                            class="pr-0"
                            fxFlexAlign="start"
                            fxFlex="18"
                            fxLayout="column"
                            fxLayoutAlign="center end"
                            [class.mat-error]="
                                form.get('productCount.additionalQtyValue').errors &&
                                !form.get('productCount.additionalQtyValue').untouched &&
                                (form.get('productCount.additionalQtyValue').dirty || form.get('productCount.additionalQtyValue').touched)
                            "
                        >
                            Additional <br/>Quantity
                        </label>

                        <div fxLayout="column" fxLayoutAlign="space-between stretch" fxLayoutGap="5px" fxFlex="80">
                            <!-- RADIO BUTTON SELECT TYPE -->
                            <mat-radio-group formControlName="additionalQtyOption">
                                <mat-radio-button class="pr-36" *ngFor="let choice of quantityChoices;" [value]="choice.id">{{ choice.label }}</mat-radio-button>
                            </mat-radio-group>
                            <!-- / RADIO BUTTON SELECT TYPE -->
                            <!-- INPUT TEXT BOX -->
                            <mat-form-field appearance="outline">
                                <input matInput
                                    name="additionalQtyValue"
                                    formControlName="additionalQtyValue"
                                    mask="separator"
                                    thousandSeparator="."
                                />
                            </mat-form-field>
                            <!-- / INPUT TEXT BOX -->
                        </div>
                    </div>
                    <!-- / ADDITIONAL QUANTITY -->
                </form>
            </div>
        </div>
        <!-- / CONTENT CARD (PENGIRIMAN PRODUK) -->
    </div>
    <!-- / CENTER -->
</div>