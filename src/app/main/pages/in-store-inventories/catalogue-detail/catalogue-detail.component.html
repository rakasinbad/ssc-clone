<div id="catalogue-detail" class="page-layout carded fullwidth inner-scroll line-height-1.75" fusePerfectScrollbar>
    <!-- TOP BACKGROUND -->
    <div class="top-bg accent"></div>
    <!-- / TOP BACKGROUND -->

    <!-- CENTER -->
    <div class="center">
        <!-- HEADER -->
        <div class="header accent" fxLayout="row" fxLayoutAlign="space-between center">
            <!-- APP TITLE -->
            <div fxLayout="row" fxLayoutAlign="start center">
                <button mat-icon-button class="mr-0 mr-sm-16" [routerLink]="['/pages/in-store-inventories']">
                    <mat-icon>arrow_back</mat-icon>
                </button>

                <div
                    class="attendance-image mr-8 mr-sm-16"
                    [@animate]="{ value: '*', params: { delay: '50ms', scale: '0.2' } }"
                >
                    <img
                        *ngIf="(selectedCatalogue$ | async)?.imageUrl; else noImage;"
                        [src]="(selectedCatalogue$ | async)?.imageUrl"
                    />
                    <ng-template #noImage>
                        <img [src]="'assets/images/avatars/profile.jpg'"/>
                    </ng-template>
                </div>

                <div
                    fxLayout="column"
                    fxLayoutAlign="start start"
                    [@animate]="{ value: '*', params: { delay: '100ms', x: '-25px' } }"
                >
                    <div class="h2">
                        <strong>{{ (selectedCatalogue$ | async)?.name }}</strong>
                    </div>

                    <div class="subtitle secondary-text">
                        <span class="fuse-white-fg">Product Detail</span>
                    </div>
                </div>
            </div>
            <!-- / APP TITLE -->
        </div>
        <!-- / HEADER -->

        <!-- CONTENT CARD -->
        <div class="sinbad-content mat-elevation-z1 fuse-white">
            <!-- MARGIN LEFT ADJUSMENT -->
            <div class="ml-20 my-20">
                <!-- CARD TITLE -->
                <!-- <div class="mt-16 mb-40">
                    <div class="h1">Store Information</div>
                </div> -->
                <!-- / CARD TITLE -->

                <div
                    class="m-16"
                    fxLayout="column"
                    fxLayoutGap="40px"
                >
                    <!-- NAMA TOKO -->
                    <div fxLayout="row" fxLayoutGap="20px">
                        <label fxFlex="20">
                            <strong>Nama Toko</strong>
                        </label>
                        <span>
                            {{ (selectedStore$ | async)?.name }}
                        </span>
                    </div>
                    <!-- / NAMA TOKO -->

                    <!-- ALAMAT TOKO -->
                    <div fxLayout="row" fxLayoutGap="20px">
                        <label fxFlex="20">
                            <strong>Alamat</strong>
                        </label>
                        <span>
                            {{ (selectedStore$ | async)?.address }}
                        </span>
                    </div>
                    <!-- / ALAMAT TOKO -->
                    
                    <!-- TOTAL SKU -->
                    <!-- <div fxLayout="row" fxLayoutGap="20px">
                        <label fxFlex="20">
                            <strong>Total SKU</strong>
                        </label>
                        <span>
                            {{ (selectedCatalogue$ | async)?.sku }}
                        </span>
                    </div> -->
                    <!-- / KARYAWAN -->
                </div>
            </div>
            <!-- / MARGIN LEFT ADJUSMENT -->
        </div>
        <!-- / CONTENT CARD -->
    </div>
    <!-- / CENTER -->

    <div class="p-32">
        <div class="sinbad-content mat-elevation-z1 fuse-white">
            <!-- CONTENT -->
            <div class="mt-20">
                <mat-table
                    class="catalogue-histories-table"
                    #table
                    [dataSource]="catalogueHistories$ | async"
                    matSort
                    [@animateStagger]="{ value: '50' }"
                    fusePerfectScrollbar
                >
                    <!-- SKU Name Column -->
                    <ng-container matColumnDef="skuName">
                        <mat-header-cell *matHeaderCellDef mat-sort-header>SKU Name</mat-header-cell>
                        <mat-cell *matCellDef="let row">
                            <p>{{ row?.storeCatalogue?.catalogue?.name }}</p>
                        </mat-cell>
                    </ng-container>

                    <!-- SKU ID Column -->
                    <ng-container matColumnDef="skuId">
                        <mat-header-cell *matHeaderCellDef mat-sort-header>SKU ID</mat-header-cell>
                        <mat-cell *matCellDef="let row">
                            <p>{{ row?.storeCatalogue?.catalogue?.sku }}</p>
                        </mat-cell>
                    </ng-container>

                    <!-- Price Column -->
                    <ng-container matColumnDef="price">
                        <mat-header-cell *matHeaderCellDef mat-sort-header>Price</mat-header-cell>
                        <mat-cell *matCellDef="let row">
                            <p>{{ row?.storeCatalogue?.catalogue?.suggestRetailPrice | price: 'full':'IDR':'symbol':'3.0-2' }}</p>
                        </mat-cell>
                    </ng-container>
                    
                    <!-- Addition Column -->
                    <ng-container matColumnDef="addition">
                        <mat-header-cell *matHeaderCellDef mat-sort-header>Addition</mat-header-cell>
                        <mat-cell *matCellDef="let row">
                            <p>{{ row?.addition ? row?.addition : '-' }}</p>
                        </mat-cell>
                    </ng-container>

                    <!-- Subtraction Column -->
                    <ng-container matColumnDef="subtraction">
                        <mat-header-cell *matHeaderCellDef mat-sort-header>Subtraction</mat-header-cell>
                        <mat-cell *matCellDef="let row">
                            <p>{{ row?.subtraction ? row?.subtraction : '-' }}</p>
                        </mat-cell>
                    </ng-container>

                    <!-- Stock on Hand Column -->
                    <ng-container matColumnDef="stockOnHand">
                        <mat-header-cell *matHeaderCellDef mat-sort-header>Stock on Hand</mat-header-cell>
                        <mat-cell *matCellDef="let row">
                            <p>{{ row?.storeCatalogue?.catalogue?.stock }}</p>
                        </mat-cell>
                    </ng-container>

                    <!-- Stock Type Column -->
                    <ng-container matColumnDef="stockType">
                        <mat-header-cell *matHeaderCellDef mat-sort-header>Type</mat-header-cell>
                        <mat-cell *matCellDef="let row">
                            <p>{{ row?.addition ? 'Stock In' : 'Stock Out' }}</p>
                        </mat-cell>
                    </ng-container>

                    <!-- Catalogue Condition Column -->
                    <ng-container matColumnDef="condition">
                        <mat-header-cell *matHeaderCellDef mat-sort-header>Condition</mat-header-cell>
                        <mat-cell *matCellDef="let row">
                            <p>{{ row?.condition?.name }}</p>
                        </mat-cell>
                    </ng-container>

                    <!-- Employee Name Column -->
                    <ng-container matColumnDef="employeeName">
                        <mat-header-cell *matHeaderCellDef mat-sort-header>Employee Name</mat-header-cell>
                        <mat-cell *matCellDef="let row">
                            <p>{{ row?.creator?.fullName }}</p>
                        </mat-cell>
                    </ng-container>
    
                    <!-- Role Column -->
                    <ng-container matColumnDef="role">
                        <mat-header-cell *matHeaderCellDef mat-sort-header>Role</mat-header-cell>
    
                        <mat-cell *matCellDef="let row" fxLayout="column" fxLayoutAlign="center start">
                            <div *ngFor="let role of row?.creator?.roles; last as $last;">
                                <ng-container *ngIf="!$last; else lastElement;">
                                    <span>{{ role.role }},</span>
                                </ng-container>
                                <ng-template #lastElement>
                                    <span>{{ role.role }}</span>
                                </ng-template>
                            </div>
                        </mat-cell>
                    </ng-container>
    
                    <!-- "UpdatedAt" Column -->
                    <ng-container matColumnDef="date">
                        <mat-header-cell *matHeaderCellDef mat-sort-header>Date</mat-header-cell>
                        <mat-cell *matCellDef="let row">
                            <p>{{ row?.updatedAt | date: 'M/dd/yyyy HH:mm:ss' }}</p>
                        </mat-cell>
                    </ng-container>
    
                    <!-- Action Column -->
                    <!-- <ng-container matColumnDef="actions">
                        <mat-header-cell *matHeaderCellDef>
                            Action
                        </mat-header-cell>
                        <mat-cell *matCellDef="let row">
                            <div fxFlex="row" fxLayoutAlign="end center">
                                <button
                                    mat-icon-button
                                    [matMenuTriggerFor]="moreMenu"
                                    aria-label="More"
                                    (click)="$event.stopPropagation()"
                                >
                                    <mat-icon class="secondary-text">more_vert</mat-icon>
                                </button>
    
                                <mat-menu #moreMenu="matMenu">
                                    <button
                                        mat-menu-item
                                        aria-label="edit"
                                        (click)="openEmployeeAttendanceDetail(row)"
                                    >
                                        <mat-icon>edit</mat-icon>
                                        <span>Edit</span>
                                    </button>
    
                                    <button mat-menu-item aria-label="remove" disabled>
                                        <mat-icon>delete</mat-icon>
                                        <span>Remove</span>
                                    </button>
                                </mat-menu>
                            </div>
                        </mat-cell>
                    </ng-container> -->
    
                    <mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></mat-header-row>
    
                    <mat-row
                        *matRowDef="let row; columns: displayedColumns"
                        class="catalogue-detail-row"
                        matRipple
                    >
                    </mat-row>
                </mat-table>
    
                <mat-paginator
                    [length]="totalCatalogueHistories$ | async"
                    [pageSize]="5"
                    [pageSizeOptions]="[5, 10, 25, 100]"
                    (page)="onChangePage()"
                    showFirstLastButtons
                >
                </mat-paginator>
            </div>
            <!-- / CONTENT -->
        </div>
    </div>
</div>


<div class="loader" *ngIf="(isHistoryLoading$ | async)">
    <mat-spinner color="accent"></mat-spinner>
</div>
