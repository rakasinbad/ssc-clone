<!-- CONTENT CARD (INFORMASI PRODUK) -->
<div [ngClass]="catalogueContent">
    <div class="p-16 pb-28">
        <div class="font-weight-600 font-size-24 line-height-20">Condition & Benefit Settings</div>
    </div>

    <div class="p-16 pt-0 pb-40 line-height-1.75">
        <form class="w-100-p" [formGroup]="form" fxLayout="column" fxFlex [fxLayoutGap]="isViewMode() ? '32px' : '5px'" novalidate>
            <!-- *HIDDEN* ID -->
            <input
                hidden
                name="id"
                formControlName="id"
            />
            <!-- / *HIDDEN* ID -->
            <!-- CALCULATION MECHANISM -->
            <div
                [ngClass]="formClass"
                fxLayout="row"
                fxLayoutAlign="start stretch"
            >
                <label
                    fxFlexAlign="center"
                    [fxFlex]="labelLength"
                    class="pr-0"
                    [class.mat-error]="!isViewMode() && hasError(form.get('calculationMechanism'))"
                >
                    Calculation<br/>Mechanism
                </label>

                <div [fxFlex]="formFieldLength" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="16px">
                    <mat-radio-group formControlName="calculationMechanism" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="16px">
                        <mat-radio-button value="non-cummulative"> Non Cummulative </mat-radio-button>
                        <mat-radio-button value="cummulative" disabled> Cummulative </mat-radio-button>
                    </mat-radio-group>

                    <a class="sinbad-blue-fg text-underline mt-4" fxFlexAlign="start" style="cursor: pointer;" (click)="openHint()">What is this?</a>
                    <!-- "WHAT IS THIS?" HINT -->
                    <ng-template #whatIsThisHint>
                        <p class="text-semibold font-size-14 sinbad-black-fg line-height-20 px-16">
                            This setting is only changeable if only when you have more than one condition & benefit configuration.
                            When you have more than one condition & benefit configuration, the default setting of the calculation mechanism will be set to non-cumulative.
                        </p>
                    </ng-template>
                    <!-- / "WHAT IS THIS?" HINT -->
                </div>
            </div>
            <!-- / CALCULATION MECHANISM -->
            <!-- CONDITION & BENEFITS -->
            <ng-container *ngFor="let control of $any(form.get('conditionBenefit').controls); index as $index">
                <!-- TITLE -->
                <p class="font-weight-600 font-size-20 line-height-20 mb-16">Condition & Benefit {{ $index + 1 }}</p>
                <!-- / TITLE -->
                <!-- WRAPPER BOX -->
                <div fxLayout="row" fxLayoutAlign="start start" fxFlex>
                    <!-- FORM -->
                    <div class="p-16 dark-box" [fxFlex]="labelLength + formFieldLength" fxLayout="column">
                        <!-- CONDITION -->
                        <span class="font-size-14 text-semibold font-weight-600 line-height-20 mb-20">
                            Condition
                        </span>
                        <!-- / CONDITION -->
                        <!-- BASE (CONDITION) -->
                        <div
                            [ngClass]="formClass"
                            fxLayout="row"
                            fxLayoutAlign="start stretch"
                        >
                            <label
                                fxFlexAlign="center"
                                [fxFlex]="labelLength * 2 - 1"
                                class="pr-0"
                                [class.mat-error]="!isViewMode() && hasError(control.get('condition.base'))"
                            >
                                Base
                            </label>

                            <mat-radio-group [formControl]="control.get('condition.base')" [fxFlex]="formFieldLength * 2 - 1" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="16px">
                                <mat-radio-button value="qty"> Qty </mat-radio-button>
                                <mat-radio-button value="order-value"> Order Value </mat-radio-button>
                            </mat-radio-group>
                        </div>
                        <!-- / BASE (CONDITION) -->
                        <!-- QTY (BASE) -->
                        <div
                            [ngClass]="formClass"
                            fxLayout="row"
                            fxLayoutAlign="start stretch"
                        >
                            <label
                                fxFlexAlign="center"
                                [fxFlex]="labelLength * 2 - 1"
                                class="pr-0"
                                [class.mat-error]="!isViewMode() && hasError(control.get('condition.qty'))"
                            >
                                Qty >=
                            </label>
                    
                            <mat-form-field appearance="outline" [fxFlex]="formFieldLength * 2 - 1" *ngIf="!isViewMode()">
                                <input
                                    matInput
                                    name="qty"
                                    type="number"
                                    [formControl]="control.get('condition.qty')"
                                />
                                <mat-error
                                    *ngIf="hasError(control.get('condition.qty'))"
                                >
                                    {{ getFormError(control.get('condition.qty')) }}
                                </mat-error>
                            </mat-form-field>
                            <span class="grey-fg" fxFlex="80" *ngIf="isViewMode()">
                                {{ control.get('condition.qty').value || '-' }}
                            </span>
                        </div>
                        <!-- / QTY (BASE) -->
                        <!-- BENEFIT -->
                        <span class="font-size-14 text-semibold font-weight-600 line-height-20 mb-20">
                            Benefit
                        </span>
                        <!-- / BENEFIT -->
                        <!-- BASE (CONDITION) -->
                        <div
                            [ngClass]="formClass"
                            fxLayout="row"
                            fxLayoutAlign="start stretch"
                        >
                            <label
                                fxFlexAlign="center"
                                [fxFlex]="labelLength * 2 - 1"
                                class="pr-0"
                                [class.mat-error]="!isViewMode() && hasError(control.get('benefit.base'))"
                            >
                                Benefit Type
                            </label>

                            <mat-radio-group [formControl]="control.get('benefit.base')" [fxFlex]="formFieldLength * 2 - 1" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="16px">
                                <mat-radio-button value="qty"> Qty </mat-radio-button>
                                <mat-radio-button value="cash"> Rp </mat-radio-button>
                                <mat-radio-button value="percent"> % </mat-radio-button>
                            </mat-radio-group>
                        </div>
                        <!-- / BASE (CONDITION) -->
                        <!-- BASE = QTY -->
                        <div [fxHide]="control.get('benefit.base').value !== 'qty'">
                            <!-- BONUS SKU -->
                            <div
                                [ngClass]="formClass"
                                fxLayout="row"
                                fxLayoutAlign="start stretch"
                            >
                                <label
                                    fxFlexAlign="center"
                                    [fxFlex]="labelLength * 2 - 1"
                                    class="pr-0"
                                    [class.mat-error]="!isViewMode() && hasError(control.get('benefit.qty.bonusSku'), { ignoreDirty: true })"
                                >
                                    <span
                                        class="sinbad-red-fg"
                                    >* </span>Bonus SKU
                                </label>
    
                                <select-catalogues mode="single" [required]="true" [fxFlex]="formFieldLength * 2 - 1" (selected)="onCatalogueSelected($event, control.get('benefit.qty.bonusSku'))">
                                    <div error>
                                        {{ getFormError(control.get('benefit.qty.bonusSku')) }}
                                    </div>
                                </select-catalogues>
                                <!-- <span class="grey-fg" fxFlex="80" *ngIf="isViewMode()">
                                    {{ form.get('benefit.qty.bonusSku').value || '-' }}
                                </span> -->
                            </div>
                            <!-- / BONUS SKU -->
                            <!-- APPLY SAME SKU -->
                            <div
                                [ngClass]="formClass"
                                fxLayout="row"
                                fxLayoutAlign="start stretch"
                            >
                                <label
                                    fxFlexAlign="center"
                                    [fxFlex]="labelLength * 2 - 1"
                                    class="pr-0"
                                ></label>

                                <mat-checkbox [fxFlex]="formFieldLength * 2 - 1" [formControl]="control.get('benefit.qty.applySameSku')">
                                    Apply Same SKU
                                </mat-checkbox>
                            </div>
                            <!-- / APPLY SAME SKU -->
                            <!-- BONUS QTY -->
                            <div
                                [ngClass]="formClass"
                                fxLayout="row"
                                fxLayoutAlign="start stretch"
                            >
                                <label
                                    fxFlexAlign="center"
                                    [fxFlex]="labelLength * 2 - 1"
                                    class="pr-0"
                                    [class.mat-error]="!isViewMode() && hasError(control.get('benefit.qty.bonusQty'))"
                                >
                                    Qty >=
                                </label>
                        
                                <mat-form-field appearance="outline" [fxFlex]="formFieldLength * 2 - 1" *ngIf="!isViewMode()">
                                    <input
                                        matInput
                                        name="qty"
                                        type="number"
                                        [formControl]="control.get('benefit.qty.bonusQty')"
                                    />
                                    <mat-error
                                        *ngIf="hasError(control.get('benefit.qty.bonusQty'))"
                                    >
                                        {{ getFormError(control.get('benefit.qty.bonusQty')) }}
                                    </mat-error>
                                </mat-form-field>
                                <span class="grey-fg" fxFlex="80" *ngIf="isViewMode()">
                                    {{ control.get('benefit.qty.bonusQty').value || '-' }}
                                </span>
                            </div>
                            <!-- / BONUS QTY -->
                            <!-- MULTIPLICATION ONLY -->
                            <div
                                [ngClass]="formClass"
                                fxLayout="row"
                                fxLayoutAlign="start stretch"
                            >
                                <label
                                    fxFlexAlign="center"
                                    [fxFlex]="labelLength * 2 - 1"
                                    class="pr-0"
                                ></label>

                                <mat-checkbox [fxFlex]="formFieldLength * 2 - 1" [formControl]="control.get('benefit.qty.multiplicationOnly')">
                                    Multiplication Only
                                </mat-checkbox>
                            </div>
                            <!-- / MULTIPLICATION ONLY -->
                        </div>
                        <!-- / BASE = QTY -->
                        <!-- BASE = CASH (Rp) -->
                        <div [fxHide]="control.get('benefit.base').value !== 'cash'">

                        </div>
                        <!-- / BASE = CASH (Rp) -->
                        <!-- BASE = PERCENT (%) -->
                        <div [fxHide]="control.get('benefit.base').value !== 'percent'">

                        </div>
                        <!-- / BASE = PERCENT (%) -->
                    </div>
                    <!-- / FORM -->
                    <!-- CARD INSTRUCTION -->
                    <card-instruction fxFlex>
                        <p class="title">Sample Case</p>

                        <p class="instruction">
                            Toko Maju Jaya ordered 5 pcs of SKU A.<br/>
                            There are 2 condition and benefits available:
                            <br/><br/>
                            Buy 5 SKU A, get 1 SKU A for free<br/>
                            Buy 10 SKU A, get 3 SKU A for free
                            <br/><br/>
                            If you choose non-cumulative:<br/>
                            Toko Maju Jaya will get 3 SKU A bonus for free.
                            <br/><br/>
                            If you choose cumulative:<br/>
                            Toko Maju Jaya will get 4 SKU A bonus for free.
                        </p>
                    </card-instruction>
                    <!-- CARD INSTRUCTION -->
                </div>
                <!-- / WRAPPER BOX -->
            </ng-container>
            <!-- / CONDITION & BENEFITS -->
        </form>
    </div>
</div>
<!-- / CONTENT CARD (INFORMASI PRODUK) -->