<mat-table
    class="period-target-promo-list-table"
    #table
    [dataSource]="dataSource$ | async"
    matSort
    [@animateStagger]="{ value: '50' }"
    fusePerfectScrollbar
>
    <!-- Checkbox Column -->
    <ng-container matColumnDef="checkbox">
        <mat-header-cell *matHeaderCellDef>
            <!-- <mat-checkbox></mat-checkbox> -->
            <mat-checkbox
                (change)="$event ? handleCheckbox() : null"
                (click)="$event.stopPropagation()"
                [checked]="selection.hasValue() && isAllSelected()"
                [indeterminate]="selection.hasValue() && !isAllSelected()"
            ></mat-checkbox>
        </mat-header-cell>
        <mat-cell *matCellDef="let row">
            <!-- <mat-checkbox></mat-checkbox> -->
            <mat-checkbox
                (click)="$event.stopPropagation()"
                (change)="$event ? selection.toggle(row) : null"
                [checked]="selection.isSelected(row)"
            ></mat-checkbox>
        </mat-cell>
    </ng-container>

    <!-- Promo Seller Id Column -->
    <ng-container matColumnDef="promo-seller-id">
        <mat-header-cell *matHeaderCellDef>
            Promo Seller ID
        </mat-header-cell>
        <mat-cell *matCellDef="let row">
            <p style="word-break: break-word;">{{ row?.promoSellerId || '-' }}</p>
        </mat-cell>
    </ng-container>

    <!-- Promo Name Column -->
    <ng-container matColumnDef="promo-name">
        <mat-header-cell *matHeaderCellDef>
            Promo Name
        </mat-header-cell>
        <mat-cell *matCellDef="let row">
            <p style="word-break: break-word;">{{ row?.promoName || '-' }}</p>
        </mat-cell>
    </ng-container>

    <!-- Base Column -->
    <ng-container matColumnDef="base">
        <mat-header-cell *matHeaderCellDef>
            Base
        </mat-header-cell>
        <mat-cell *matCellDef="let row">
            <p style="word-break: break-word;">{{ row?.base || '-' }}</p>
        </mat-cell>
    </ng-container>

    <!-- Start Date Column -->
    <ng-container matColumnDef="start-date">
        <mat-header-cell *matHeaderCellDef>
            Start Date
        </mat-header-cell>
        <mat-cell *matCellDef="let row">
            <p style="word-break: break-word;">{{ (row?.startDate | date: 'dd/MM/yyyy') || '-' }}</p>
        </mat-cell>
    </ng-container>

    <!-- End Date Column -->
    <ng-container matColumnDef="end-date">
        <mat-header-cell *matHeaderCellDef>
            End Date
        </mat-header-cell>
        <mat-cell *matCellDef="let row">
            <p style="word-break: break-word;">{{ (row?.endDate | date: 'dd/MM/yyyy') || '-' }}</p>
        </mat-cell>
    </ng-container>

    <!-- Status Column -->
    <ng-container matColumnDef="status">
        <mat-header-cell *matHeaderCellDef>
            Status
        </mat-header-cell>
        <mat-cell *matCellDef="let row">
            <ng-container *ngIf="row?.status; else noStatus;">
                <mat-icon
                    class="active-icon s-24"
                    [matTooltip]="row?.status | titlecase"
                    svgIcon="sinbad-check-active"
                    *ngIf="row?.status === 'active'"
                >
                </mat-icon>

                <mat-icon
                    class="active-icon s-24"
                    [matTooltip]="row?.status | titlecase"
                    svgIcon="sinbad-check-inactive"
                    *ngIf="row?.status === 'inactive'"
                >
                </mat-icon>
            </ng-container>

            <ng-template #noStatus>
                -
            </ng-template>
        </mat-cell>
    </ng-container>

    <!-- Actions Column -->
    <ng-container matColumnDef="actions">
        <mat-header-cell *matHeaderCellDef>
            Actions
        </mat-header-cell>
        <mat-cell *matCellDef="let row">
            <div fxFlex="row" fxLayoutAlign="end center">
                <button
                    mat-icon-button
                    [matMenuTriggerFor]="moreMenu"
                    aria-label="More"
                    (click)="$event.stopPropagation()"
                >
                    <mat-icon class="secondary-text">more_vert</mat-icon>
                </button>

                <mat-menu #moreMenu="matMenu">
                    <ng-template [ngxPermissionsOnly]="['SRM.SR.UPDATE']">
                        <button
                            type="button"
                            mat-menu-item
                            class="sinbad-mat-menu-item"
                            aria-label="Edit"
                        >
                            <mat-icon>edit</mat-icon>
                            <span>Edit</span>
                        </button>

                        <!-- <button
                            type="button"
                            mat-menu-item
                            class="sinbad-mat-menu-item"
                            aria-label="Edit"
                            (click)="onEditSkuAssignment(row)"
                        >
                            <mat-icon>edit</mat-icon>
                            <span>Edit</span>
                        </button> -->

                        <!--<button
                            mat-menu-item
                            type="button"
                            class="sinbad-mat-menu-item"
                            [attr.aria-label]="
                                row?.status === 'active' ? 'Inactive' : 'Active'
                            "
                            (click)="onChangeStatus(row)"
                        >
                            <mat-icon>
                                {{
                                    row?.status === 'active'
                                        ? 'archive'
                                        : 'check_circle_outline'
                                }}
                            </mat-icon>
                            <span>
                                {{
                                    (row?.status === 'active'
                                        ? 'ACTION.INACTIVE'
                                        : 'ACTION.ACTIVE'
                                    ) | translate
                                }}
                            </span>
                        </button> -->
                    </ng-template>
                </mat-menu>
            </div>
        </mat-cell>
    </ng-container>

    <mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></mat-header-row>

    <mat-row *matRowDef="let row; columns: displayedColumns" class="flexicombo"></mat-row>
    <!-- <mat-row
        *matRowDef="let row; columns: displayedColumns"
        class="flexicombo"
        (click)="$event.stopPropagation(); onSkuAssignmentDetail(row)"
    ></mat-row> -->
</mat-table>

<div class="no-records" *ngIf="isLoading$ | async">
    <mat-spinner color="accent"></mat-spinner>
</div>

<div class="no-records" *ngIf="!(isLoading$ | async) && (totalDataSource$ | async) === 0">
    No records found
</div>

<mat-paginator
    [fxHide]="
        ((isLoading$ | async) && !(totalDataSource$ | async)) ||
        (!(isLoading$ | async) && (totalDataSource$ | async) === 0)
    "
    [length]="totalDataSource$ | async"
    [pageSize]="defaultPageSize"
    [pageSizeOptions]="defaultPageOpts"
    showFirstLastButtons
></mat-paginator>
