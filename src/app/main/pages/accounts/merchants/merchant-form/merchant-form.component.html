<div
    id="merchants"
    class="page-layout carded fullwidth inner-scroll"
    cdkScrollable
    fusePerfectScrollbar
>
    <!-- TOP BACKGROUND -->
    <div class="accent"></div>
    <!-- / TOP BACKGROUND -->

    <!-- CENTER -->
    <div class="center">
        <form
            id="merchant-form"
            name="merchantForm"
            class="merchant pt-24 w-100-p"
            [formGroup]="form"
            fxLayout="column"
            fxFlex
            novalidate
        >
            <mat-card class="mb-24" formGroupName="profileInfo">
                <div fxLayout="column">
                    <span class="mat-headline">
                        Profile Information
                    </span>

                    <div>
                        <!-- <div class="custom-field" fxLayout="row" fxLayoutAlign="start stretch">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="
                                    form.get('profileInfo.username').errors &&
                                    !form.get('profileInfo.username').untouched &&
                                    (form.get('profileInfo.username').dirty ||
                                        form.get('profileInfo.username').touched)
                                "
                            >
                                *Username
                            </label>

                            <mat-form-field appearance="outline" fxFlex="100">
                                <input
                                    matInput
                                    name="username"
                                    formControlName="username"
                                    maxlength="30"
                                />

                                <mat-error
                                    *ngIf="
                                        form.get('profileInfo.username').errors &&
                                        (form.get('profileInfo.username').dirty ||
                                            form.get('profileInfo.username').touched)
                                    "
                                >
                                    {{ getErrorMessage('profileInfo.username') }}
                                </mat-error>
                            </mat-form-field>
                        </div> -->

                        <div class="custom-field" fxLayout="row" fxLayoutAlign="start stretch">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="hasError('profileInfo.phoneNumber')"
                            >
                                Phone Number
                            </label>

                            <mat-form-field appearance="outline" fxFlex="100">
                                <input
                                    matInput
                                    type="tel"
                                    name="phoneNumber"
                                    formControlName="phoneNumber"
                                    maxlength="30"
                                />

                                <mat-error *ngIf="hasError('profileInfo.phoneNumber', true)">
                                    {{ getErrorMessage('profileInfo.phoneNumber') }}
                                </mat-error>
                            </mat-form-field>
                        </div>

                        <div class="custom-field" fxLayout="row" fxLayoutAlign="start stretch">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="hasError('profileInfo.photos')"
                            >
                                Store Photo
                            </label>

                            <div fxLayout="row" fxFlex="100" fxLayoutAlign="start center">
                                <mat-form-field
                                    class="sinbad-file-field"
                                    appearance="outline"
                                    fxFlex="40"
                                    [class.mat-sinbad-field-error]="hasError('profileInfo.photos')"
                                >
                                    <input
                                        #photoPicker
                                        type="file"
                                        class="custom-file"
                                        accept=".jpg, .jpeg, .png"
                                        formControlName="photos"
                                        (change)="onFileBrowse($event, 'photo')"
                                    />
                                    <input
                                        matInput
                                        name="photos"
                                        [formControl]="tmpPhoto"
                                        placeholder="No file choose"
                                    />

                                    <mat-hint
                                        class="mat-error"
                                        *ngIf="hasError('profileInfo.photos', true)"
                                    >
                                        {{ getErrorMessage('profileInfo.photos') }}
                                    </mat-hint>
                                </mat-form-field>

                                <button
                                    mat-flat-button
                                    color="accent"
                                    type="button"
                                    (click)="photoPicker.click()"
                                    fxFlexAlign="center"
                                >
                                    Upload your file
                                </button>

                                <ng-container
                                    *ngIf="pageType === 'edit' && (stores$ | async) as stores"
                                >
                                    <a
                                        [href]="stores?.imageUrl"
                                        target="_blank"
                                        *ngIf="stores?.imageUrl"
                                        style="position: relative; top: -0.78em;"
                                    >
                                        <mat-icon>remove_red_eye</mat-icon>
                                    </a>
                                </ng-container>
                            </div>
                        </div>

                        <div class="custom-field" fxLayout="row" fxLayoutAlign="start stretch">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="hasError('profileInfo.npwpId')"
                            >
                                NPWP ID
                            </label>

                            <mat-form-field appearance="outline" fxFlex="100">
                                <input
                                    matInput
                                    name="npwpId"
                                    formControlName="npwpId"
                                    mask="00.000.000.0-000.000"
                                    [validation]="false"
                                />

                                <mat-error *ngIf="hasError('profileInfo.npwpId', true)">
                                    {{ getErrorMessage('profileInfo.npwpId') }}
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </div>
                </div>
            </mat-card>

            <mat-card class="mb-24" formGroupName="storeInfo">
                <div fxLayout="column">
                    <span class="mat-headline">
                        Store Information
                    </span>

                    <div class="form-box" formGroupName="storeId">
                        <span class="mat-subheading-2">Store ID</span>

                        <div
                            class="custom-field-right mt-20"
                            fxLayout="row"
                            fxLayoutAlign="start center"
                        >
                            <label
                                fxFlexAlign="start"
                                fxFlex="12"
                                [class.mat-error]="hasError('storeInfo.storeId.id')"
                                class="pt-16"
                            >
                                *ID
                            </label>

                            <div fxLayout="column" fxLayoutAlign="start stretch" fxFlex="50">
                                <div fxLayout="row" fxLayoutAlign="start start" class="mt-8">
                                    <!-- RADIO GROUP -->
                                    <mat-radio-group [formControl]="storeIdType" class="pt-8">
                                        <mat-radio-button value="manual">Manually</mat-radio-button>
                                        <mat-radio-button
                                            value="auto"
                                            [disabled]="!storeIdNextNumber || isEditMode"
                                        >
                                            Auto Generate
                                            <span class="grey-fg">
                                                ({{ storeIdNextNumber || '-' }})
                                            </span>
                                        </mat-radio-button>
                                    </mat-radio-group>
                                    <!-- / RADIO GROUP -->
                                    <!-- HELP -->
                                    <mat-icon
                                        class="grey-fg"
                                        style="font-size: 16px;"
                                        matTooltip="You can change this AutoGenerate Store ID Number in Store Setting"
                                        >help</mat-icon
                                    >
                                    <!-- / HELP -->
                                </div>
                                <!-- FORM FIELD INPUT -->
                                <mat-form-field
                                    appearance="outline"
                                    [@animate]="{
                                        value: '*',
                                        params: { delay: '100ms', x: '-25px' }
                                    }"
                                    [fxHide]="this.storeIdType.value === 'auto'"
                                >
                                    <input matInput name="id" formControlName="id" />

                                    <mat-error *ngIf="hasError('storeInfo.storeId.id', true)">
                                        {{ getErrorMessage('storeInfo.storeId.id') }}
                                    </mat-error>
                                </mat-form-field>
                                <!-- / FORM FIELD INPUT -->
                            </div>
                        </div>

                        <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="hasError('storeInfo.storeId.storeName')"
                            >
                                *Store Name
                            </label>

                            <mat-form-field appearance="outline" fxFlex="50">
                                <input matInput name="storeName" formControlName="storeName" />

                                <mat-error *ngIf="hasError('storeInfo.storeId.storeName', true)">
                                    {{ getErrorMessage('storeInfo.storeId.storeName') }}
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </div>

                    <div class="form-box" formGroupName="address">
                        <span class="mat-subheading-2">Address</span>

                        <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="hasError('storeInfo.address.district')"
                            >
                                *District
                            </label>

                            <mat-form-field appearance="outline" fxFlex="50">
                                <input
                                    #triggerDistrict
                                    matInput
                                    formControlName="district"
                                    placeholder="Search District"
                                    aria-label="District"
                                    [matAutocomplete]="autoDistrict"
                                    (keyup)="onKeyup($event, 'district')"
                                    (keydown)="onKeydown($event, 'district')"
                                />

                                <mat-autocomplete
                                    #autoDistrict="matAutocomplete"
                                    [displayWith]="onDisplayDistrict"
                                    (opened)="onOpenAutocomplete('district')"
                                    (optionSelected)="onSelectAutocomplete($event, 'district')"
                                >
                                    <!-- <mat-option *ngIf="isLoadingDistrict$ | async">
                                        Loading...
                                    </mat-option> -->
                                    <mat-option
                                        *ngIf="!(isLoadingDistrict$ | async) && isDistrictTyping"
                                    >
                                        Searching...
                                    </mat-option>
                                    <!-- <ng-container
                                        *ngIf="!(isLoadingDistrict$ | async) && !isDistrictTyping"
                                    > -->
                                    <ng-container
                                        *ngIf="
                                            !isDistrictTyping && (districts$ | async)?.length > 0
                                        "
                                    >
                                        <!-- <cdk-virtual-scroll-viewport
                                                #cdkDistrict
                                                itemSize="5"
                                                class="viewport-select"
                                                (scrolledIndexChange)="onScroll($event, 'district')"
                                            >
                                                <mat-option
                                                    *cdkVirtualFor="let source of d2Source$"
                                                    [value]="source"
                                                >
                                                    <ng-container *ngIf="source">
                                                        <span
                                                            [innerHtml]="
                                                                source?.province?.name +
                                                                    ', ' +
                                                                    source?.city +
                                                                    ', ' +
                                                                    source?.district
                                                                    | highlight: districtHighlight
                                                            "
                                                        ></span>
                                                    </ng-container>

                                                    <ng-container *ngIf="!source">Loading...</ng-container>
                                                </mat-option>
                                            </cdk-virtual-scroll-viewport> -->

                                        <ng-container
                                            *ngIf="
                                                districts$ | async as districts;
                                                else noDistricts
                                            "
                                        >
                                            <mat-option
                                                *ngFor="let source of districts"
                                                [value]="source"
                                                [attr.title]="displayDistrictOption(source)"
                                            >
                                                <ng-container
                                                    *ngIf="source && !(isLoadingDistrict$ | async)"
                                                >
                                                    <span
                                                        [innerHtml]="
                                                            displayDistrictOption(source, true)
                                                                | highlight: districtHighlight
                                                        "
                                                    ></span>
                                                </ng-container>

                                                <ng-container
                                                    *ngIf="!source || (isLoadingDistrict$ | async)"
                                                >
                                                    Loading...
                                                </ng-container>
                                            </mat-option>

                                            <!-- <cdk-virtual-scroll-viewport
                                                #cdkDistrict
                                                itemSize="5"
                                                class="viewport-select"
                                                (scrolledIndexChange)="onScroll($event, 'district')"
                                            >
                                                <mat-option
                                                    *cdkVirtualFor="let source of d2Source"
                                                    [value]="source"
                                                >
                                                    <ng-container *ngIf="source">
                                                        <span
                                                            [innerHtml]="
                                                                source?.province?.name +
                                                                    ', ' +
                                                                    source?.city +
                                                                    ', ' +
                                                                    source?.district
                                                                    | highlight: districtHighlight
                                                            "
                                                        ></span>
                                                    </ng-container>

                                                    <ng-container *ngIf="!source">Loading...</ng-container>
                                                </mat-option>
                                            </cdk-virtual-scroll-viewport> -->
                                        </ng-container>

                                        <ng-template #noDistricts>
                                            <mat-option>None</mat-option>
                                        </ng-template>
                                    </ng-container>

                                    <ng-container
                                        *ngIf="!isDistrictTyping && !(districts$ | async)?.length"
                                    >
                                        <mat-option>None</mat-option>
                                    </ng-container>
                                </mat-autocomplete>

                                <mat-hint
                                    align="end"
                                    *ngIf="hasLength('storeInfo.address.district', 3)"
                                >
                                    Please enter 3 or more characters.
                                </mat-hint>

                                <mat-error *ngIf="hasError('storeInfo.address.district', true)">
                                    {{ getErrorMessage('storeInfo.address.district') }}
                                </mat-error>
                            </mat-form-field>
                        </div>

                        <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="hasError('storeInfo.address.urban')"
                            >
                                *Urban
                            </label>

                            <mat-form-field appearance="outline" fxFlex="50">
                                <input
                                    #triggerUrban
                                    matInput
                                    formControlName="urban"
                                    placeholder="Search Urban"
                                    aria-label="Urban"
                                    [matAutocomplete]="autoUrban"
                                    (keyup)="onKeyup($event, 'urban')"
                                    (keydown)="onKeydown($event, 'urban')"
                                />

                                <mat-autocomplete
                                    #autoUrban="matAutocomplete"
                                    [displayWith]="onDisplayUrban"
                                    (optionSelected)="onSelectAutocomplete($event, 'urban')"
                                >
                                    <mat-option *ngIf="isUrbanTyping">
                                        Searching...
                                    </mat-option>

                                    <ng-container
                                        *ngIf="!isUrbanTyping && (urbans$ | async)?.length > 0"
                                    >
                                        <ng-container
                                            *ngIf="urbans$ | async as urbans; else noUrbans"
                                        >
                                            <mat-option
                                                *ngFor="let source of urbans"
                                                [value]="source"
                                                [attr.title]="displayUrbanOption(source)"
                                            >
                                                <ng-container *ngIf="source">
                                                    <span
                                                        [innerHtml]="
                                                            displayUrbanOption(source, true)
                                                                | highlight: urbanHighlight
                                                        "
                                                    ></span>
                                                </ng-container>

                                                <ng-container *ngIf="!source">
                                                    Loading...
                                                </ng-container>
                                            </mat-option>
                                        </ng-container>

                                        <ng-template #noUrbans>
                                            <mat-option>None</mat-option>
                                        </ng-template>
                                    </ng-container>

                                    <ng-container
                                        *ngIf="!isUrbanTyping && !(urbans$ | async)?.length"
                                    >
                                        <mat-option>None</mat-option>
                                    </ng-container>
                                </mat-autocomplete>

                                <mat-error *ngIf="hasError('storeInfo.address.urban', true)">
                                    {{ getErrorMessage('storeInfo.address.urban') }}
                                </mat-error>
                            </mat-form-field>
                        </div>

                        <!-- <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="
                                    form.get('storeInfo.address.province').errors &&
                                    !form.get('storeInfo.address.province').untouched &&
                                    (form.get('storeInfo.address.province').dirty ||
                                        form.get('storeInfo.address.province').touched)
                                "
                            >
                                *Province
                            </label>

                            <mat-form-field appearance="outline" fxFlex="50">
                                <ng-container
                                    *ngIf="provinces$ | async as provinces; else noProvinces"
                                >
                                    <mat-select
                                        formControlName="province"
                                        placeholder="Choose Province"
                                        (openedChange)="onOpenChangeProvince($event)"
                                        (selectionChange)="onSelectProvince($event)"
                                    >
                                        <cdk-virtual-scroll-viewport
                                            #cdkProvince
                                            itemSize="5"
                                            minBufferPx="200"
                                            maxBufferPx="400"
                                            class="viewport-select"
                                        >
                                            <mat-option>None</mat-option>
                                            <mat-option
                                                *cdkVirtualFor="let row of provinces"
                                                [value]="row?.id"
                                            >
                                                {{ row?.name }}
                                            </mat-option>
                                            <mat-option
                                                *ngIf="
                                                    form.get('storeInfo.address.province')?.value
                                                "
                                                [value]="
                                                    form.get('storeInfo.address.province')?.value
                                                "
                                            >
                                                {{ form.get('storeInfo.address.province')?.value }}
                                            </mat-option>
                                        </cdk-virtual-scroll-viewport>
                                    </mat-select>
                                </ng-container>

                                <ng-template #noProvinces>
                                    <mat-select placeholder="Choose Province" disabled>
                                        <mat-option>Province not found</mat-option>
                                    </mat-select>
                                </ng-template>

                                <mat-error
                                    *ngIf="
                                        form.get('storeInfo.address.province').errors &&
                                        (form.get('storeInfo.address.province').dirty ||
                                            form.get('storeInfo.address.province').touched)
                                    "
                                >
                                    {{ getErrorMessage('storeInfo.address.province') }}
                                </mat-error>
                            </mat-form-field>
                        </div>

                        <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="
                                    form.get('storeInfo.address.city').errors &&
                                    !form.get('storeInfo.address.city').untouched &&
                                    (form.get('storeInfo.address.city').dirty ||
                                        form.get('storeInfo.address.city').touched)
                                "
                            >
                                *City
                            </label>

                            <mat-form-field appearance="outline" fxFlex="50">
                                <ng-container *ngIf="cities$ | async as cities; else noCities">
                                    <mat-select
                                        formControlName="city"
                                        placeholder="Choose City"
                                        (openedChange)="onOpenChangeCity($event)"
                                        (selectionChange)="onSelectCity($event)"
                                    >
                                        <cdk-virtual-scroll-viewport
                                            #cdkCity
                                            itemSize="5"
                                            minBufferPx="200"
                                            maxBufferPx="400"
                                            class="viewport-select"
                                        >
                                            <mat-option>None</mat-option>
                                            <mat-option
                                                *cdkVirtualFor="let row of cities"
                                                [value]="row?.city"
                                            >
                                                {{ row?.city }}
                                            </mat-option>
                                            <mat-option
                                                *ngIf="form.get('storeInfo.address.city')?.value"
                                                [value]="form.get('storeInfo.address.city')?.value"
                                            >
                                                {{ form.get('storeInfo.address.city')?.value }}
                                            </mat-option>
                                        </cdk-virtual-scroll-viewport>
                                    </mat-select>
                                </ng-container>

                                <ng-template #noCities>
                                    <mat-select placeholder="Choose City" disabled>
                                        <mat-option>City not found</mat-option>
                                    </mat-select>
                                </ng-template>

                                <mat-error
                                    *ngIf="
                                        form.get('storeInfo.address.city').errors &&
                                        (form.get('storeInfo.address.city').dirty ||
                                            form.get('storeInfo.address.city').touched)
                                    "
                                >
                                    {{ getErrorMessage('storeInfo.address.city') }}
                                </mat-error>
                            </mat-form-field>
                        </div>

                        <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="
                                    form.get('storeInfo.address.district').errors &&
                                    !form.get('storeInfo.address.district').untouched &&
                                    (form.get('storeInfo.address.district').dirty ||
                                        form.get('storeInfo.address.district').touched)
                                "
                            >
                                *Kecamatan
                            </label>

                            <mat-form-field appearance="outline" fxFlex="50">
                                <ng-container
                                    *ngIf="districts$ | async as districts; else noDistricts"
                                >
                                    <mat-select
                                        formControlName="district"
                                        placeholder="Choose District"
                                        (openedChange)="onOpenChangeDistrict($event)"
                                        (selectionChange)="onSelectDistrict($event)"
                                    >
                                        <cdk-virtual-scroll-viewport
                                            #cdkDistrict2
                                            itemSize="5"
                                            minBufferPx="200"
                                            maxBufferPx="400"
                                            class="viewport-select"
                                        >
                                            <mat-option>None</mat-option>
                                            <mat-option
                                                *cdkVirtualFor="let row of districts"
                                                [value]="row?.district"
                                            >
                                                {{ row?.district }}
                                            </mat-option>
                                            <mat-option
                                                *ngIf="
                                                    form.get('storeInfo.address.district')?.value
                                                "
                                                [value]="
                                                    form.get('storeInfo.address.district')?.value
                                                "
                                            >
                                                {{ form.get('storeInfo.address.district')?.value }}
                                            </mat-option>
                                        </cdk-virtual-scroll-viewport>
                                    </mat-select>
                                </ng-container>

                                <ng-template #noDistricts>
                                    <mat-select placeholder="Choose District" disabled>
                                        <mat-option>District not found</mat-option>
                                    </mat-select>
                                </ng-template>

                                <mat-error
                                    *ngIf="
                                        form.get('storeInfo.address.district').errors &&
                                        (form.get('storeInfo.address.district').dirty ||
                                            form.get('storeInfo.address.district').touched)
                                    "
                                >
                                    {{ getErrorMessage('storeInfo.address.district') }}
                                </mat-error>
                            </mat-form-field>
                        </div>

                        <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="
                                    form.get('storeInfo.address.urban').errors &&
                                    !form.get('storeInfo.address.urban').untouched &&
                                    (form.get('storeInfo.address.urban').dirty ||
                                        form.get('storeInfo.address.urban').touched)
                                "
                            >
                                *Kelurahan
                            </label>

                            <mat-form-field appearance="outline" fxFlex="50">
                                <ng-container *ngIf="urbans$ | async as urbans; else noUrbans">
                                    <mat-select
                                        formControlName="urban"
                                        placeholder="Choose Urban"
                                        (openedChange)="onOpenChangeUrban($event)"
                                        (selectionChange)="onSelectUrban($event)"
                                    >
                                        <cdk-virtual-scroll-viewport
                                            #cdkUrban
                                            itemSize="5"
                                            minBufferPx="200"
                                            maxBufferPx="400"
                                            class="viewport-select"
                                        >
                                            <mat-option>None</mat-option>
                                            <mat-option
                                                *cdkVirtualFor="let row of urbans"
                                                [value]="row?.id"
                                            >
                                                {{ row?.urban }}
                                            </mat-option>
                                            <mat-option
                                                *ngIf="form.get('storeInfo.address.urban')?.value"
                                                [value]="form.get('storeInfo.address.urban')?.value"
                                            >
                                                {{ form.get('storeInfo.address.urban')?.value }}
                                            </mat-option>
                                        </cdk-virtual-scroll-viewport>
                                    </mat-select>
                                </ng-container>

                                <ng-template #noUrbans>
                                    <mat-select placeholder="Choose Urban" disabled>
                                        <mat-option>Urban not found</mat-option>
                                    </mat-select>
                                </ng-template>

                                <mat-error
                                    *ngIf="
                                        form.get('storeInfo.address.urban').errors &&
                                        (form.get('storeInfo.address.urban').dirty ||
                                            form.get('storeInfo.address.urban').touched)
                                    "
                                >
                                    {{ getErrorMessage('storeInfo.address.urban') }}
                                </mat-error>
                            </mat-form-field>
                        </div> -->

                        <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="hasError('storeInfo.address.postcode')"
                            >
                                *Postcode
                            </label>

                            <mat-form-field appearance="outline" fxFlex="50">
                                <input
                                    matInput
                                    formControlName="postcode"
                                    mask="00000"
                                    [validation]="false"
                                />

                                <!-- <mat-select
                                    formControlName="postcode"
                                    placeholder="Choose postcode..."
                                >
                                    <mat-option>12440</mat-option>
                                </mat-select> -->

                                <mat-error *ngIf="hasError('storeInfo.address.postcode', true)">
                                    {{ getErrorMessage('storeInfo.address.postcode') }}
                                </mat-error>
                            </mat-form-field>
                        </div>

                        <div
                            class="custom-field-right sinbad-textarea"
                            fxLayout="row"
                            fxLayoutAlign="start center"
                        >
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="hasError('storeInfo.address.notes')"
                            >
                                *Notes
                            </label>

                            <mat-form-field appearance="outline" fxFlex="50">
                                <textarea matInput formControlName="notes" rows="5"></textarea>

                                <mat-error *ngIf="hasError('storeInfo.address.notes', true)">
                                    {{ getErrorMessage('storeInfo.address.notes') }}
                                </mat-error>
                            </mat-form-field>
                        </div>

                        <ng-container formGroupName="geolocation">
                            <div
                                class="custom-field-right"
                                fxLayout="row"
                                fxLayoutAlign="start center"
                            >
                                <label
                                    fxFlexAlign="center"
                                    fxFlex="12"
                                    [class.mat-error]="
                                        hasError('storeInfo.address.geolocation.lat')
                                    "
                                >
                                    Latitude
                                </label>

                                <mat-form-field appearance="outline" fxFlex="50">
                                    <input matInput formControlName="lat" />

                                    <mat-error
                                        *ngIf="hasError('storeInfo.address.geolocation.lat', true)"
                                    >
                                        {{ getErrorMessage('storeInfo.address.geolocation.lat') }}
                                    </mat-error>
                                </mat-form-field>
                            </div>

                            <div
                                class="custom-field-right"
                                fxLayout="row"
                                fxLayoutAlign="start center"
                            >
                                <label
                                    fxFlexAlign="center"
                                    fxFlex="12"
                                    [class.mat-error]="
                                        hasError('storeInfo.address.geolocation.lng')
                                    "
                                >
                                    Longitude
                                </label>

                                <mat-form-field appearance="outline" fxFlex="50">
                                    <input matInput formControlName="lng" />

                                    <mat-error
                                        *ngIf="hasError('storeInfo.address.geolocation.lng', true)"
                                    >
                                        {{ getErrorMessage('storeInfo.address.geolocation.lng') }}
                                    </mat-error>
                                </mat-form-field>
                            </div>
                        </ng-container>

                        <!-- <div
                            class="custom-field-right sinbad-button"
                            fxLayout="row"
                            fxLayoutAlign="start center"
                        >
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="
                                    form.get('storeInfo.address.geolocation').errors &&
                                    !form.get('storeInfo.address.geolocation').untouched &&
                                    (form.get('storeInfo.address.geolocation').dirty ||
                                        form.get('storeInfo.address.geolocation').touched)
                                "
                            >
                                *Geolocation
                            </label>

                            <button mat-flat-button color="accent">Set GeoLoc</button>

                            <mat-form-field appearance="outline" fxFlex="50">
                                <textarea matInput formControlName="notes" rows="5"></textarea>

                                <mat-error
                                    *ngIf="
                                        form.get('storeInfo.address.geolocation').errors &&
                                        (form.get('storeInfo.address.geolocation').dirty ||
                                            form.get('storeInfo.address.geolocation').touched)
                                    "
                                >
                                    {{ getErrorMessage('storeInfo.address.geolocation') }}
                                </mat-error>
                            </mat-form-field>
                        </div> -->
                    </div>

                    <!--  *ngIf="pageType === 'new'" -->

                    <div class="form-box mt-16" formGroupName="legalInfo">
                        <span class="mat-subheading-2">Legal Information</span>

                        <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="hasError('storeInfo.legalInfo.name')"
                            >
                                *Owner Name
                            </label>

                            <mat-form-field appearance="outline" fxFlex="50">
                                <input matInput name="name" formControlName="name" />

                                <mat-error *ngIf="hasError('storeInfo.legalInfo.name', true)">
                                    {{ getErrorMessage('storeInfo.legalInfo.name') }}
                                </mat-error>
                            </mat-form-field>
                        </div>

                        <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="hasError('storeInfo.legalInfo.identityId')"
                            >
                                KTP ID
                            </label>

                            <mat-form-field appearance="outline" fxFlex="50">
                                <input
                                    matInput
                                    name="identityId"
                                    formControlName="identityId"
                                    mask="0000000000000000"
                                />

                                <mat-error *ngIf="hasError('storeInfo.legalInfo.identityId', true)">
                                    {{ getErrorMessage('storeInfo.legalInfo.identityId') }}
                                </mat-error>
                            </mat-form-field>
                        </div>

                        <div
                            class="custom-field-right"
                            fxLayout="row"
                            fxLayoutAlign="start stretch"
                        >
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="hasError('storeInfo.legalInfo.identityPhoto')"
                            >
                                KTP Photo
                            </label>

                            <div fxLayout="row" fxFlex="100">
                                <mat-form-field
                                    class="sinbad-file-field"
                                    appearance="outline"
                                    fxFlex="40"
                                    [class.mat-sinbad-field-error]="
                                        hasError('storeInfo.legalInfo.identityPhoto')
                                    "
                                >
                                    <input
                                        #identityPhotoPicker
                                        type="file"
                                        class="custom-file"
                                        accept=".jpg, .jpeg, .png"
                                        formControlName="identityPhoto"
                                        (change)="onFileBrowse($event, 'identityPhoto')"
                                    />
                                    <input
                                        matInput
                                        name="identityPhoto"
                                        [formControl]="tmpIdentityPhoto"
                                        placeholder="No file choose"
                                    />

                                    <mat-hint
                                        class="mat-error"
                                        *ngIf="hasError('storeInfo.legalInfo.identityPhoto', true)"
                                    >
                                        {{ getErrorMessage('storeInfo.legalInfo.identityPhoto') }}
                                    </mat-hint>
                                </mat-form-field>

                                <button
                                    mat-flat-button
                                    color="accent"
                                    type="button"
                                    (click)="identityPhotoPicker.click()"
                                    fxFlexAlign="center"
                                >
                                    Upload your file
                                </button>

                                <ng-container
                                    *ngIf="pageType === 'edit' && (stores$ | async) as stores"
                                >
                                    <a
                                        [href]="stores?.owner?.idImageUrl"
                                        target="_blank"
                                        *ngIf="stores?.owner?.idImageUrl"
                                        style="position: relative; top: -0.78em;"
                                    >
                                        <mat-icon>remove_red_eye</mat-icon>
                                    </a>
                                </ng-container>
                            </div>
                        </div>

                        <div
                            class="custom-field-right"
                            fxLayout="row"
                            fxLayoutAlign="start stretch"
                        >
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="
                                    hasError('storeInfo.legalInfo.identityPhotoSelfie')
                                "
                            >
                                KTP Photo + Selfie
                            </label>

                            <div fxLayout="row" fxFlex="100">
                                <mat-form-field
                                    class="sinbad-file-field"
                                    appearance="outline"
                                    fxFlex="40"
                                    [class.mat-sinbad-field-error]="
                                        hasError('storeInfo.legalInfo.identityPhotoSelfie')
                                    "
                                >
                                    <input
                                        #identityPhotoSelfiePicker
                                        type="file"
                                        class="custom-file"
                                        accept=".jpg, .jpeg, .png"
                                        formControlName="identityPhotoSelfie"
                                        (change)="onFileBrowse($event, 'identityPhotoSelfie')"
                                    />
                                    <input
                                        matInput
                                        name="identityPhotoSelfie"
                                        [formControl]="tmpIdentityPhotoSelfie"
                                        placeholder="No file choose"
                                    />

                                    <mat-hint
                                        class="mat-error"
                                        *ngIf="
                                            hasError(
                                                'storeInfo.legalInfo.identityPhotoSelfie',
                                                true
                                            )
                                        "
                                    >
                                        {{
                                            getErrorMessage(
                                                'storeInfo.legalInfo.identityPhotoSelfie'
                                            )
                                        }}
                                    </mat-hint>
                                </mat-form-field>

                                <button
                                    mat-flat-button
                                    color="accent"
                                    type="button"
                                    (click)="identityPhotoSelfiePicker.click()"
                                    fxFlexAlign="center"
                                >
                                    Upload your file
                                </button>

                                <ng-container
                                    *ngIf="pageType === 'edit' && (stores$ | async) as stores"
                                >
                                    <a
                                        [href]="stores?.owner?.taxImageUrl"
                                        target="_blank"
                                        *ngIf="stores?.owner?.taxImageUrl"
                                        style="position: relative; top: -0.78em;"
                                    >
                                        <mat-icon>remove_red_eye</mat-icon>
                                    </a>
                                </ng-container>
                            </div>
                        </div>

                        <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="hasError('storeInfo.legalInfo.npwpId')"
                            >
                                NPWP ID
                            </label>

                            <mat-form-field appearance="outline" fxFlex="50">
                                <input
                                    matInput
                                    name="npwpId"
                                    formControlName="npwpId"
                                    mask="00.000.000.0-000.000"
                                    [validation]="false"
                                />

                                <mat-error *ngIf="hasError('storeInfo.legalInfo.npwpId', true)">
                                    {{ getErrorMessage('storeInfo.legalInfo.npwpId') }}
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </div>

                    <div class="form-box" formGroupName="physicalStoreInfo">
                        <span class="mat-subheading-2">Physical Store Information</span>

                        <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="
                                    hasError('storeInfo.physicalStoreInfo.numberOfEmployee')
                                "
                            >
                                Number of Employee
                            </label>

                            <mat-form-field appearance="outline" fxFlex="50">
                                <ng-container *ngIf="numberOfEmployees; else noNumberOfEmployees">
                                    <mat-select
                                        formControlName="numberOfEmployee"
                                        placeholder="Choose Number of Employees"
                                    >
                                        <mat-option>None</mat-option>
                                        <mat-option
                                            *ngFor="let row of numberOfEmployees"
                                            [value]="row?.id"
                                        >
                                            {{ row?.label }}
                                        </mat-option>
                                    </mat-select>
                                </ng-container>

                                <ng-template #noNumberOfEmployees>
                                    <mat-select
                                        formControlName="numberOfEmployee"
                                        placeholder="Choose Number of Employees"
                                    >
                                        <mat-option>Number of Employee not found</mat-option>
                                    </mat-select>
                                </ng-template>

                                <mat-error
                                    *ngIf="
                                        hasError(
                                            'storeInfo.physicalStoreInfo.numberOfEmployee',
                                            true
                                        )
                                    "
                                >
                                    {{
                                        getErrorMessage(
                                            'storeInfo.physicalStoreInfo.numberOfEmployee'
                                        )
                                    }}
                                </mat-error>
                            </mat-form-field>
                        </div>

                        <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="
                                    hasError('storeInfo.physicalStoreInfo.vehicleAccessibility')
                                "
                            >
                                Vehicle Accessibility
                            </label>

                            <mat-form-field appearance="outline" fxFlex="50">
                                <ng-container
                                    *ngIf="
                                        vehicleAccessibilities$ | async as vehicleAccessibilities;
                                        else noVehicleAccessibilities
                                    "
                                >
                                    <mat-select
                                        formControlName="vehicleAccessibility"
                                        placeholder="Choose Vehicle Accessibility"
                                    >
                                        <mat-option>None</mat-option>
                                        <mat-option
                                            *ngFor="let row of vehicleAccessibilities"
                                            [value]="row?.id"
                                        >
                                            {{ row?.name }}
                                        </mat-option>
                                    </mat-select>
                                </ng-container>

                                <ng-template #noVehicleAccessibilities>
                                    <mat-select
                                        formControlName="vehicleAccessibility"
                                        placeholder="Choose Vehicle Accessibility"
                                    >
                                        <mat-option>Vehicle Accessibility not found</mat-option>
                                    </mat-select>
                                </ng-template>

                                <mat-error
                                    *ngIf="
                                        hasError(
                                            'storeInfo.physicalStoreInfo.vehicleAccessibility',
                                            true
                                        )
                                    "
                                >
                                    {{
                                        getErrorMessage(
                                            'storeInfo.physicalStoreInfo.vehicleAccessibility'
                                        )
                                    }}
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </div>

                    <!-- Store Classification Group -->
                    <div class="form-box" formGroupName="storeClassification">
                        <span class="mat-subheading-2">Store Classification</span>

                        <!-- Store Type Field -->
                        <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                class="reset-top"
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="
                                    hasError('storeInfo.storeClassification.storeType')
                                "
                            >
                                Store Type
                            </label>

                            <a
                                class="sinbad-red-fg py-12 selected-selection-tree"
                                fxLayout="row"
                                fxLayoutAlign="start center"
                                (click)="onSelectStoreType()"
                                [innerHTML]="(selectedStoreType$ | async).lastSaved | safe: 'html'"
                            ></a>

                            <!-- <mat-form-field appearance="outline" fxFlex="50">
                                <ng-container
                                    *ngIf="storeTypes$ | async as storeTypes; else noStoreTypes"
                                >
                                    <mat-select
                                        formControlName="storeType"
                                        placeholder="Choose Store Type"
                                    >
                                        <mat-option>None</mat-option>
                                        <mat-option
                                            *ngFor="let row of storeTypes"
                                            [value]="row?.id"
                                        >
                                            {{ row?.name | titlecase }}
                                        </mat-option>
                                    </mat-select>
                                </ng-container>

                                <ng-template #noStoreTypes>
                                    <mat-select
                                        formControlName="storeType"
                                        placeholder="Choose Store Type"
                                    >
                                        <mat-option>Store Type not found</mat-option>
                                    </mat-select>
                                </ng-template>

                                <mat-error
                                    *ngIf="
                                        hasError('storeInfo.storeClassification.storeType', true)
                                    "
                                >
                                    {{ getErrorMessage('storeInfo.storeClassification.storeType') }}
                                </mat-error>
                            </mat-form-field> -->
                        </div>

                        <!-- Store Group Field -->
                        <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                class="reset-top"
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="
                                    hasError('storeInfo.storeClassification.storeGroup')
                                "
                            >
                                Store Group
                            </label>

                            <a
                                class="sinbad-red-fg py-12 selected-selection-tree"
                                fxLayout="row"
                                fxLayoutAlign="start center"
                                (click)="onSelectStoreGroup()"
                                [innerHTML]="(selectedStoreGroup$ | async).lastSaved | safe: 'html'"
                            ></a>

                            <!-- <mat-form-field appearance="outline" fxFlex="50">
                                <ng-container
                                    *ngIf="storeGroups$ | async as storeGroups; else noStoreGroups"
                                >
                                    <mat-select
                                        formControlName="storeGroup"
                                        placeholder="Choose Store Group"
                                    >
                                        <mat-option>None</mat-option>
                                        <mat-option
                                            *ngFor="let row of storeGroups"
                                            [value]="row?.id"
                                        >
                                            {{ row?.name | titlecase }}
                                        </mat-option>
                                    </mat-select>
                                </ng-container>

                                <ng-template #noStoreGroups>
                                    <mat-select
                                        formControlName="storeGroup"
                                        placeholder="Choose Store Group"
                                    >
                                        <mat-option>Store Group not found</mat-option>
                                    </mat-select>
                                </ng-template>

                                <mat-error
                                    *ngIf="
                                        hasError('storeInfo.storeClassification.storeGroup', true)
                                    "
                                >
                                    {{
                                        getErrorMessage('storeInfo.storeClassification.storeGroup')
                                    }}
                                </mat-error>
                            </mat-form-field> -->

                            <!-- <button
                                type="button"
                                mat-icon-button
                                color="accent"
                                aria-label="Reset"
                                style="position: relative;top: -0.78em"
                                (click)="onResetField('storeInfo.storeClassification.storeGroup')"
                                *ngIf="form.get('storeInfo.storeClassification.storeGroup').value"
                            >
                                <mat-icon>refresh</mat-icon>
                            </button> -->
                        </div>

                        <!-- Store Channel Field -->
                        <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                class="reset-top"
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="
                                    hasError('storeInfo.storeClassification.storeChannel')
                                "
                            >
                                Store Channel
                            </label>

                            <a
                                class="sinbad-red-fg py-12 selected-selection-tree"
                                fxLayout="row"
                                fxLayoutAlign="start center"
                                (click)="onSelectStoreChannel()"
                                [innerHTML]="
                                    (selectedStoreChannel$ | async).lastSaved | safe: 'html'
                                "
                            ></a>

                            <!-- <mat-form-field appearance="outline" fxFlex="50">
                                <ng-container
                                    *ngIf="
                                        storeClusters$ | async as storeClusters;
                                        else noStoreClusters
                                    "
                                >
                                    <mat-select
                                        formControlName="storeCluster"
                                        placeholder="Choose Store Cluster"
                                    >
                                        <mat-option>None</mat-option>
                                        <mat-option
                                            *ngFor="let row of storeClusters"
                                            [value]="row?.id"
                                        >
                                            {{ row?.name }}
                                        </mat-option>
                                    </mat-select>
                                </ng-container>

                                <ng-template #noStoreClusters>
                                    <mat-select
                                        formControlName="storeCluster"
                                        placeholder="Choose Store Cluster"
                                    >
                                        <mat-option>Store Cluster not found</mat-option>
                                    </mat-select>
                                </ng-template>

                                <mat-error
                                    *ngIf="
                                        hasError('storeInfo.storeClassification.storeCluster', true)
                                    "
                                >
                                    {{
                                        getErrorMessage(
                                            'storeInfo.storeClassification.storeCluster'
                                        )
                                    }}
                                </mat-error>
                            </mat-form-field>

                            <button
                                type="button"
                                mat-icon-button
                                color="accent"
                                aria-label="Reset"
                                style="position: relative;top: -0.78em"
                                (click)="onResetField('storeInfo.storeClassification.storeCluster')"
                                *ngIf="form.get('storeInfo.storeClassification.storeCluster').value"
                            >
                                <mat-icon>refresh</mat-icon>
                            </button> -->
                        </div>

                        <!-- Store Cluster Field -->
                        <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                class="reset-top"
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="
                                    hasError('storeInfo.storeClassification.storeCluster')
                                "
                            >
                                Store Cluster
                            </label>

                            <a
                                class="sinbad-red-fg py-12 selected-selection-tree"
                                fxLayout="row"
                                fxLayoutAlign="start center"
                                (click)="onSelectStoreCluster()"
                                [innerHTML]="
                                    (selectedStoreCluster$ | async).lastSaved | safe: 'html'
                                "
                            ></a>
                        </div>

                        <!-- Store Segment Field -->
                        <!-- <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="
                                    hasError('storeInfo.storeClassification.storeSegment')
                                "
                            >
                                Store Segment
                            </label>

                            <mat-form-field appearance="outline" fxFlex="50">
                                <ng-container
                                    *ngIf="
                                        storeSegments$ | async as storeSegments;
                                        else noStoreSegments
                                    "
                                >
                                    <mat-select
                                        formControlName="storeSegment"
                                        placeholder="Choose Store Segment"
                                    >
                                        <mat-option>None</mat-option>
                                        <mat-option
                                            *ngFor="let row of storeSegments"
                                            [value]="row?.id"
                                        >
                                            {{ row?.name | uppercase }}
                                        </mat-option>
                                    </mat-select>
                                </ng-container>

                                <ng-template #noStoreSegments>
                                    <mat-select
                                        formControlName="storeSegment"
                                        placeholder="Choose Store Segment"
                                    >
                                        <mat-option>Store Segment not found</mat-option>
                                    </mat-select>
                                </ng-template>

                                <mat-error
                                    *ngIf="
                                        hasError('storeInfo.storeClassification.storeSegment', true)
                                    "
                                >
                                    {{
                                        getErrorMessage(
                                            'storeInfo.storeClassification.storeSegment'
                                        )
                                    }}
                                </mat-error>
                            </mat-form-field>
                        </div> -->

                        <!-- Customer Hierarchy Field -->
                        <!-- <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="
                                    hasError('storeInfo.storeClassification.hierarchy')
                                "
                            >
                                Hierarchy
                            </label>

                            <mat-form-field appearance="outline" fxFlex="50">
                                <ng-container
                                    *ngIf="hierarchies$ | async as hierarchies; else noHierarchies"
                                >
                                    <mat-select
                                        formControlName="hierarchy"
                                        placeholder="Choose Hierarchy"
                                    >
                                        <mat-option>None</mat-option>
                                        <mat-option
                                            *ngFor="let row of hierarchies"
                                            [value]="row?.id"
                                        >
                                            {{ row?.name | uppercase }}
                                        </mat-option>
                                    </mat-select>
                                </ng-container>

                                <ng-template #noHierarchies>
                                    <mat-select placeholder="Choose Hierarchy" disabled>
                                        <mat-option>Hierarchy not found</mat-option>
                                    </mat-select>
                                </ng-template>

                                <mat-error
                                    *ngIf="
                                        hasError('storeInfo.storeClassification.hierarchy', true)
                                    "
                                >
                                    {{ getErrorMessage('storeInfo.storeClassification.hierarchy') }}
                                </mat-error>
                            </mat-form-field>
                        </div> -->
                    </div>

                    <!-- Payment Group -->
                    <div class="form-box" formGroupName="payment">
                        <span class="mat-subheading-2">Payment</span>

                        <!-- Credit Limit Form Array -->
                        <ng-container
                            formArrayName="creditLimit"
                            *ngFor="
                                let creditLimit of creditLimitControls;
                                index as i;
                                odd as odd;
                                even as even
                            "
                        >
                            <ng-container [formGroupName]="i">
                                <div class="px-4 py-4" [class.bg-f9f9f9-simple]="odd">
                                    <div class="mb-8">
                                        <span class="text-boxed">
                                            {{ tempInvoiceGroupName[i] }}
                                        </span>
                                    </div>

                                    <!-- Allow Credit Field -->
                                    <div
                                        class="custom-field-right"
                                        fxLayout="row"
                                        fxLayoutAlign="start center"
                                    >
                                        <div style="margin-left: 50px; margin-top: 10px;">
                                            <mat-slide-toggle
                                                [labelPosition]="'before'"
                                                formControlName="allowCreditLimit"
                                                (change)="onChangeAllowCredit($event, i)"
                                            >
                                                Allow Credit
                                            </mat-slide-toggle>
                                        </div>
                                    </div>

                                    <!-- Credit Limit Field -->
                                    <div
                                        class="custom-field-right"
                                        fxLayout="row"
                                        fxLayoutAlign="start center"
                                    >
                                        <label
                                            fxFlexAlign="center"
                                            fxFlex="12"
                                            [class.mat-error]="
                                                formCreditLimits.controls[i].get('creditLimit')
                                                    .errors &&
                                                (formCreditLimits.controls[i].get('creditLimit')
                                                    .dirty ||
                                                    formCreditLimits.controls[i].get('creditLimit')
                                                        .touched)
                                            "
                                            [attr.disabled]="
                                                formCreditLimits.controls[i].get('creditLimit')
                                                    .disabled
                                                    ? true
                                                    : null
                                            "
                                        >
                                            {{ tempCreditLimitAmount[i] ? '*' : '' }}Value
                                        </label>

                                        <mat-form-field appearance="outline" fxFlex="50">
                                            <input
                                                matInput
                                                name="creditLimit"
                                                formControlName="creditLimit"
                                                mask="separator.2"
                                                thousandSeparator="."
                                                prefix="Rp"
                                                placeholder="Rp"
                                            />

                                            <mat-error
                                                *ngIf="
                                                    formCreditLimits.controls[i].get('creditLimit')
                                                        .errors &&
                                                    (formCreditLimits.controls[i].get('creditLimit')
                                                        .dirty ||
                                                        formCreditLimits.controls[i].get(
                                                            'creditLimit'
                                                        ).touched)
                                                "
                                            >
                                                {{
                                                    getErrorMessageArray(
                                                        'storeInfo.payment.creditLimit',
                                                        'creditLimit',
                                                        i
                                                    )
                                                }}
                                            </mat-error>
                                        </mat-form-field>
                                    </div>

                                    <!-- Term of Payment Field -->
                                    <div
                                        class="custom-field-right"
                                        fxLayout="row"
                                        fxLayoutAlign="start center"
                                    >
                                        <label
                                            fxFlexAlign="center"
                                            fxFlex="12"
                                            [class.mat-error]="
                                                formCreditLimits.controls[i].get('termOfPayment')
                                                    .errors &&
                                                (formCreditLimits.controls[i].get('termOfPayment')
                                                    .dirty ||
                                                    formCreditLimits.controls[i].get(
                                                        'termOfPayment'
                                                    ).touched)
                                            "
                                            [attr.disabled]="
                                                formCreditLimits.controls[i].get('termOfPayment')
                                                    .disabled
                                                    ? true
                                                    : null
                                            "
                                        >
                                            {{ tempTermOfPayment[i] ? '*' : '' }}ToP
                                        </label>

                                        <mat-form-field appearance="outline" fxFlex="50">
                                            <input
                                                matInput
                                                name="termOfPayment"
                                                formControlName="termOfPayment"
                                                suffix=" days"
                                                mask="0*"
                                                placeholder="days"
                                            />

                                            <mat-error
                                                *ngIf="
                                                    formCreditLimits.controls[i].get(
                                                        'termOfPayment'
                                                    ).errors &&
                                                    (formCreditLimits.controls[i].get(
                                                        'termOfPayment'
                                                    ).dirty ||
                                                        formCreditLimits.controls[i].get(
                                                            'termOfPayment'
                                                        ).touched)
                                                "
                                            >
                                                {{
                                                    getErrorMessageArray(
                                                        'storeInfo.payment.creditLimit',
                                                        'termOfPayment',
                                                        i
                                                    )
                                                }}
                                            </mat-error>
                                        </mat-form-field>
                                    </div>

                                    <!-- Credit Limit Group Field -->
                                    <div
                                        class="custom-field-right"
                                        fxLayout="row"
                                        fxLayoutAlign="start center"
                                    >
                                        <label
                                            fxFlexAlign="center"
                                            fxFlex="12"
                                            [class.mat-error]="
                                                formCreditLimits.controls[i].get('creditLimitGroup')
                                                    .errors &&
                                                (formCreditLimits.controls[i].get(
                                                    'creditLimitGroup'
                                                ).dirty ||
                                                    formCreditLimits.controls[i].get(
                                                        'creditLimitGroup'
                                                    ).touched)
                                            "
                                            [attr.disabled]="
                                                formCreditLimits.controls[i].get('creditLimitGroup')
                                                    .disabled
                                                    ? true
                                                    : null
                                            "
                                        >
                                            Set Credit Limit Group
                                        </label>

                                        <mat-form-field appearance="outline" fxFlex="50">
                                            <ng-container
                                                *ngIf="
                                                    creditLimitGroups$ | async as creditLimitGroups;
                                                    else noCreditLimitGroups
                                                "
                                            >
                                                <mat-select
                                                    formControlName="creditLimitGroup"
                                                    placeholder="Choose Credit Limit Group"
                                                    (selectionChange)="
                                                        onSelectCreditLimitGroup($event, i)
                                                    "
                                                >
                                                    <mat-option
                                                        *ngFor="let row of creditLimitGroups"
                                                        [value]="row?.id"
                                                    >
                                                        {{ row?.name }}
                                                    </mat-option>
                                                </mat-select>
                                            </ng-container>

                                            <ng-template #noCreditLimitGroups>
                                                <mat-select
                                                    placeholder="Choose Credit Limit Group"
                                                    disabled
                                                >
                                                    <mat-option>
                                                        Credit Limit Group not found
                                                    </mat-option>
                                                </mat-select>
                                            </ng-template>

                                            <ng-container *ngIf="formCreditLimits.controls[i].get('creditLimitGroup')">
                                                <mat-error
                                                    *ngIf="
                                                        formCreditLimits.controls[i].get(
                                                            'creditLimitGroup'
                                                        ).errors &&
                                                        (formCreditLimits.controls[i].get(
                                                            'creditLimitGroup'
                                                        ).dirty ||
                                                            formCreditLimits.controls[i].get(
                                                                'creditLimitGroup'
                                                            ).touched)
                                                    "
                                                >
                                                    {{
                                                        getErrorMessageArray(
                                                            'storeInfo.payment.creditLimit',
                                                            'creditLimitGroup',
                                                            i
                                                        )
                                                    }}
                                                </mat-error>
                                            </ng-container>
                                        </mat-form-field>

                                        <button
                                            type="button"
                                            mat-icon-button
                                            color="accent"
                                            aria-label="Reset"
                                            style="position: relative; top: -0.78em;"
                                            (click)="onResetCreditLimitGroup(i)"
                                            *ngIf="
                                                formCreditLimits.controls[i].get('creditLimitGroup')
                                                    .value
                                            "
                                        >
                                            <mat-icon>refresh</mat-icon>
                                        </button>
                                    </div>
                                </div>
                            </ng-container>
                        </ng-container>

                        <!-- <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="
                                    form.get('storeInfo.storeClassification.storeCluster').errors &&
                                    !form.get('storeInfo.storeClassification.storeCluster')
                                        .untouched &&
                                    (form.get('storeInfo.storeClassification.storeCluster').dirty ||
                                        form.get('storeInfo.storeClassification.storeCluster')
                                            .touched)
                                "
                            >
                                *Store Cluster
                            </label>

                            <mat-form-field appearance="outline" fxFlex="50">
                                <ng-container
                                    *ngIf="
                                        storeClusters$ | async as storeClusters;
                                        else noStoreClusters
                                    "
                                >
                                    <mat-select
                                        formControlName="storeCluster"
                                        placeholder="Choose Store Cluster"
                                    >
                                        <mat-option
                                            *ngFor="let row of storeClusters"
                                            [value]="row?.id"
                                        >
                                            {{ row?.name }}
                                        </mat-option>
                                    </mat-select>
                                </ng-container>

                                <ng-template #noStoreClusters>
                                    <mat-select
                                        formControlName="storeCluster"
                                        placeholder="Choose Store Cluster"
                                    >
                                        <mat-option>Store Cluster not found</mat-option>
                                    </mat-select>
                                </ng-template>

                                <mat-error
                                    *ngIf="
                                        form.get('storeInfo.storeClassification.storeCluster')
                                            .errors &&
                                        (form.get('storeInfo.storeClassification.storeCluster')
                                            .dirty ||
                                            form.get('storeInfo.storeClassification.storeCluster')
                                                .touched)
                                    "
                                >
                                    {{
                                        getErrorMessage(
                                            'storeInfo.storeClassification.storeCluster'
                                        )
                                    }}
                                </mat-error>
                            </mat-form-field>
                        </div> -->

                        <!-- Store Segment Field -->
                        <!-- <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="
                                    form.get('storeInfo.storeClassification.storeSegment').errors &&
                                    !form.get('storeInfo.storeClassification.storeSegment')
                                        .untouched &&
                                    (form.get('storeInfo.storeClassification.storeSegment').dirty ||
                                        form.get('storeInfo.storeClassification.storeSegment')
                                            .touched)
                                "
                            >
                                *Store Segment
                            </label>

                            <mat-form-field appearance="outline" fxFlex="50">
                                <ng-container
                                    *ngIf="
                                        storeSegments$ | async as storeSegments;
                                        else noStoreSegments
                                    "
                                >
                                    <mat-select
                                        formControlName="storeSegment"
                                        placeholder="Choose Store Segment"
                                    >
                                        <mat-option
                                            *ngFor="let row of storeSegments"
                                            [value]="row?.id"
                                        >
                                            {{ row?.name | uppercase }}
                                        </mat-option>
                                    </mat-select>
                                </ng-container>

                                <ng-template #noStoreSegments>
                                    <mat-select
                                        formControlName="storeSegment"
                                        placeholder="Choose Store Segment"
                                    >
                                        <mat-option>Store Segment not found</mat-option>
                                    </mat-select>
                                </ng-template>

                                <mat-error
                                    *ngIf="
                                        form.get('storeInfo.storeClassification.storeSegment')
                                            .errors &&
                                        (form.get('storeInfo.storeClassification.storeSegment')
                                            .dirty ||
                                            form.get('storeInfo.storeClassification.storeSegment')
                                                .touched)
                                    "
                                >
                                    {{
                                        getErrorMessage(
                                            'storeInfo.storeClassification.storeSegment'
                                        )
                                    }}
                                </mat-error>
                            </mat-form-field>
                        </div> -->

                        <!-- Customer Hierarchy Field -->
                        <!-- <div class="custom-field-right" fxLayout="row" fxLayoutAlign="start center">
                            <label
                                fxFlexAlign="center"
                                fxFlex="12"
                                [class.mat-error]="
                                    form.get('storeInfo.storeClassification.hierarchy').errors &&
                                    !form.get('storeInfo.storeClassification.hierarchy')
                                        .untouched &&
                                    (form.get('storeInfo.storeClassification.hierarchy').dirty ||
                                        form.get('storeInfo.storeClassification.hierarchy').touched)
                                "
                            >
                                Hierarchy
                            </label>

                            <mat-form-field appearance="outline" fxFlex="50">
                                <ng-container
                                    *ngIf="hierarchies$ | async as hierarchies; else noHierarchies"
                                >
                                    <mat-select
                                        formControlName="hierarchy"
                                        placeholder="Choose Hierarchy"
                                    >
                                        <mat-option
                                            *ngFor="let row of hierarchies"
                                            [value]="row?.id"
                                        >
                                            {{ row?.name | uppercase }}
                                        </mat-option>
                                    </mat-select>
                                </ng-container>

                                <ng-template #noHierarchies>
                                    <mat-select placeholder="Choose Hierarchy" disabled>
                                        <mat-option>Hierarchy not found</mat-option>
                                    </mat-select>
                                </ng-template>

                                <mat-error
                                    *ngIf="
                                        form.get('storeInfo.storeClassification.hierarchy')
                                            .errors &&
                                        (form.get('storeInfo.storeClassification.hierarchy')
                                            .dirty ||
                                            form.get('storeInfo.storeClassification.hierarchy')
                                                .touched)
                                    "
                                >
                                    {{ getErrorMessage('storeInfo.storeClassification.hierarchy') }}
                                </mat-error>
                            </mat-form-field>
                        </div> -->
                    </div>
                </div>
            </mat-card>
        </form>
    </div>
    <!-- / CENTER -->
</div>

<div class="loader" *ngIf="isLoading$ | async">
    <mat-spinner color="accent"></mat-spinner>
</div>

<ng-template #selectStoreType>
    <tree-store-segmentation
        [segmentationType]="'type'"
        (selected)="onStoreTypeSelected($event)"
        (selectionChanged)="onStoreTypeSelectionChanged($event)"
    >
    </tree-store-segmentation>
</ng-template>
<ng-template #selectStoreGroup>
    <tree-store-segmentation
        [segmentationType]="'group'"
        (selected)="onStoreGroupSelected($event)"
        (selectionChanged)="onStoreGroupSelectionChanged($event)"
    >
    </tree-store-segmentation>
</ng-template>
<ng-template #selectStoreChannel>
    <tree-store-segmentation
        [segmentationType]="'channel'"
        (selected)="onStoreChannelSelected($event)"
        (selectionChanged)="onStoreChannelSelectionChanged($event)"
    >
    </tree-store-segmentation>
</ng-template>
<ng-template #selectStoreCluster>
    <tree-store-segmentation
        [segmentationType]="'cluster'"
        (selected)="onStoreClusterSelected($event)"
        (selectionChanged)="onStoreClusterSelectionChanged($event)"
    >
    </tree-store-segmentation>
</ng-template>
